<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-| This module provides efficient and streaming left folds that you can combine
    using 'Applicative' style.

    Import this module qualified to avoid clashing with the Prelude:

&gt;&gt;&gt; import qualified Control.Foldl as L

    Use 'fold' to apply a 'Fold' to a list:

&gt;&gt;&gt; L.fold L.sum [1..100]
5050

    'Fold's are 'Applicative's, so you can combine them using 'Applicative'
    combinators:

&gt;&gt;&gt; import Control.Applicative
&gt;&gt;&gt; let average = (/) &lt;$&gt; L.sum &lt;*&gt; L.genericLength

    Taking the sum, the sum of squares, ..., upto the sum of x^5

&gt;&gt;&gt; import Data.Traversable
&gt;&gt;&gt; let powerSums = sequenceA [L.premap (^n) L.sum | n &lt;- [1..5]]
&gt;&gt;&gt; L.fold powerSums [1..10]
[55,385,3025,25333,220825]

    These combined folds will still traverse the list only once, streaming
    efficiently over the list in constant space without space leaks:

&gt;&gt;&gt; L.fold average [1..10000000]
5000000.5
&gt;&gt;&gt; L.fold ((,) &lt;$&gt; L.minimum &lt;*&gt; L.maximum) [1..10000000]
(Just 1,Just 10000000)

    You might want to try enabling the @-flate-dmd-anal@ flag when compiling
    executables that use this library to further improve performance.
-}</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-pragma">{-# LANGUAGE BangPatterns              #-}</span><span>
</span><a name="line-39"></a><span class="hs-pragma">{-# LANGUAGE CPP                       #-}</span><span>
</span><a name="line-40"></a><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><a name="line-41"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts          #-}</span><span>
</span><a name="line-42"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes                #-}</span><span>
</span><a name="line-43"></a><span class="hs-pragma">{-# LANGUAGE Trustworthy               #-}</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Foldl</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-comment">-- * Fold Types</span><span>
</span><a name="line-47"></a><span>      </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>
</span><a name="line-50"></a><span>    </span><span class="hs-comment">-- * Folding</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#fold"><span class="hs-identifier hs-var">fold</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#foldM"><span class="hs-identifier hs-var">foldM</span></a><span>
</span><a name="line-53"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#scan"><span class="hs-identifier hs-var">scan</span></a><span>
</span><a name="line-54"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#prescan"><span class="hs-identifier hs-var">prescan</span></a><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#postscan"><span class="hs-identifier hs-var">postscan</span></a><span>
</span><a name="line-57"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-58"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-comment">-- * Folds</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#mconcat"><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Foldl</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mconcat</span></a><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#foldMap"><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Foldl</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldMap</span></a><span>
</span><a name="line-63"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#head"><span class="hs-identifier hs-var">head</span></a><span>
</span><a name="line-64"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#last"><span class="hs-identifier hs-var">last</span></a><span>
</span><a name="line-65"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#lastDef"><span class="hs-identifier hs-var">lastDef</span></a><span>
</span><a name="line-66"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#lastN"><span class="hs-identifier hs-var">lastN</span></a><span>
</span><a name="line-67"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#null"><span class="hs-identifier hs-var">null</span></a><span>
</span><a name="line-68"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#length"><span class="hs-identifier hs-var">length</span></a><span>
</span><a name="line-69"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#and"><span class="hs-identifier hs-var">and</span></a><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#or"><span class="hs-identifier hs-var">or</span></a><span>
</span><a name="line-71"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#all"><span class="hs-identifier hs-var">all</span></a><span>
</span><a name="line-72"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#any"><span class="hs-identifier hs-var">any</span></a><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#sum"><span class="hs-identifier hs-var">sum</span></a><span>
</span><a name="line-74"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#product"><span class="hs-identifier hs-var">product</span></a><span>
</span><a name="line-75"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#mean"><span class="hs-identifier hs-var">mean</span></a><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#variance"><span class="hs-identifier hs-var">variance</span></a><span>
</span><a name="line-77"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#std"><span class="hs-identifier hs-var">std</span></a><span>
</span><a name="line-78"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#maximum"><span class="hs-identifier hs-var">maximum</span></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#maximumBy"><span class="hs-identifier hs-var">maximumBy</span></a><span>
</span><a name="line-80"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#minimum"><span class="hs-identifier hs-var">minimum</span></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#minimumBy"><span class="hs-identifier hs-var">minimumBy</span></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#elem"><span class="hs-identifier hs-var">elem</span></a><span>
</span><a name="line-83"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#notElem"><span class="hs-identifier hs-var">notElem</span></a><span>
</span><a name="line-84"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#find"><span class="hs-identifier hs-var">find</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#index"><span class="hs-identifier hs-var">index</span></a><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#elemIndex"><span class="hs-identifier hs-var">elemIndex</span></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a><span>
</span><a name="line-89"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#random"><span class="hs-identifier hs-var">random</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#randomN"><span class="hs-identifier hs-var">randomN</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#mapM_"><span class="hs-identifier hs-var">Control</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Foldl</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapM_</span></a><span>
</span><a name="line-92"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#sink"><span class="hs-identifier hs-var">sink</span></a><span>
</span><a name="line-93"></a><span>
</span><a name="line-94"></a><span>    </span><span class="hs-comment">-- * Generic Folds</span><span>
</span><a name="line-95"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#genericLength"><span class="hs-identifier hs-var">genericLength</span></a><span>
</span><a name="line-96"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#genericIndex"><span class="hs-identifier hs-var">genericIndex</span></a><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span>    </span><span class="hs-comment">-- * Container folds</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#list"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-100"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#revList"><span class="hs-identifier hs-var">revList</span></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#nub"><span class="hs-identifier hs-var">nub</span></a><span>
</span><a name="line-102"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#eqNub"><span class="hs-identifier hs-var">eqNub</span></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#set"><span class="hs-identifier hs-var">set</span></a><span>
</span><a name="line-104"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#hashSet"><span class="hs-identifier hs-var">hashSet</span></a><span>
</span><a name="line-105"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#map"><span class="hs-identifier hs-var">map</span></a><span>
</span><a name="line-106"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#hashMap"><span class="hs-identifier hs-var">hashMap</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#vector"><span class="hs-identifier hs-var">vector</span></a><span>
</span><a name="line-108"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#vectorM"><span class="hs-identifier hs-var">vectorM</span></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>    </span><span class="hs-comment">-- * Utilities</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-comment">-- $utilities</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#purely"><span class="hs-identifier hs-var">purely</span></a><span>
</span><a name="line-113"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#purely_"><span class="hs-identifier hs-var">purely_</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#impurely"><span class="hs-identifier hs-var">impurely</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#impurely_"><span class="hs-identifier hs-var">impurely_</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#generalize"><span class="hs-identifier hs-var">generalize</span></a><span>
</span><a name="line-117"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#simplify"><span class="hs-identifier hs-var">simplify</span></a><span>
</span><a name="line-118"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#hoists"><span class="hs-identifier hs-var">hoists</span></a><span>
</span><a name="line-119"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#duplicateM"><span class="hs-identifier hs-var">duplicateM</span></a><span>
</span><a name="line-120"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span>
</span><a name="line-121"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#premap"><span class="hs-identifier hs-var">premap</span></a><span>
</span><a name="line-122"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#premapM"><span class="hs-identifier hs-var">premapM</span></a><span>
</span><a name="line-123"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#prefilter"><span class="hs-identifier hs-var">prefilter</span></a><span>
</span><a name="line-124"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#prefilterM"><span class="hs-identifier hs-var">prefilterM</span></a><span>
</span><a name="line-125"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span>
</span><a name="line-126"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#handles"><span class="hs-identifier hs-var">handles</span></a><span>
</span><a name="line-127"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#foldOver"><span class="hs-identifier hs-var">foldOver</span></a><span>
</span><a name="line-128"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-type">EndoM</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#HandlerM"><span class="hs-identifier hs-type">HandlerM</span></a><span>
</span><a name="line-130"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#handlesM"><span class="hs-identifier hs-var">handlesM</span></a><span>
</span><a name="line-131"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#foldOverM"><span class="hs-identifier hs-var">foldOverM</span></a><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#folded"><span class="hs-identifier hs-var">folded</span></a><span>
</span><a name="line-133"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#filtered"><span class="hs-identifier hs-var">filtered</span></a><span>
</span><a name="line-134"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.html#groupBy"><span class="hs-identifier hs-var">groupBy</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-comment">-- * Re-exports</span><span>
</span><a name="line-137"></a><span>    </span><span class="hs-comment">-- $reexports</span><span>
</span><a name="line-138"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Primitive</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span>
</span><a name="line-140"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span>
</span><a name="line-141"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span>
</span><a name="line-144"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Foldl.Internal.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Foldl</span><span class="hs-operator">.</span><span class="hs-identifier">Internal</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#Maybe%27"><span class="hs-identifier hs-type">Maybe'</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.Internal.html#lazy"><span class="hs-identifier hs-var">lazy</span></a><span class="hs-special">,</span><span> </span><a href="Control.Foldl.Internal.html#Either%27"><span class="hs-identifier hs-type">Either'</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Control.Foldl.Internal.html#hush"><span class="hs-identifier hs-var">hush</span></a><span class="hs-special">)</span><span>
</span><a name="line-145"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;=&lt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Primitive</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimMonad</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">RealWorld</span><span class="hs-special">)</span><span>
</span><a name="line-147"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Comonad</span><span>
</span><a name="line-148"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Foldable</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Functor</span><span class="hs-operator">.</span><span class="hs-identifier">Identity</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Identity</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">runIdentity</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Functor</span><span class="hs-operator">.</span><span class="hs-identifier">Contravariant</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Contravariant</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">alter</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-153"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Semigroup</span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Profunctor</span><span>
</span><a name="line-156"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Sequence</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">|&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Vector</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Mutable</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span class="hs-operator">.</span><span class="hs-identifier">Mutable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MVector</span><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Hashable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Hashable</span><span class="hs-special">)</span><span>
</span><a name="line-160"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span class="hs-operator">.</span><span class="hs-identifier">MWC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">GenIO</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">createSystemRandom</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">uniformR</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Prelude</span><span> </span><span class="hs-keyword">hiding</span><span>
</span><a name="line-162"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">head</span><span>
</span><a name="line-163"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">last</span><span>
</span><a name="line-164"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">null</span><span>
</span><a name="line-165"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">length</span><span>
</span><a name="line-166"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">and</span><span>
</span><a name="line-167"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">or</span><span>
</span><a name="line-168"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">all</span><span>
</span><a name="line-169"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">any</span><span>
</span><a name="line-170"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">sum</span><span>
</span><a name="line-171"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">product</span><span>
</span><a name="line-172"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">maximum</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">minimum</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elem</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">notElem</span><span>
</span><a name="line-176"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">lookup</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">map</span><span>
</span><a name="line-178"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>
</span><a name="line-180"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-181"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">List</span><span>
</span><a name="line-182"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Sequence</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Seq</span><span>
</span><a name="line-183"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-184"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-185"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">HashMap</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HashMap</span><span>
</span><a name="line-186"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">HashSet</span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">HashSet</span><span>
</span><a name="line-187"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span>         </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">V</span><span>
</span><a name="line-188"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span class="hs-operator">.</span><span class="hs-identifier">Generic</span><span class="hs-operator">.</span><span class="hs-identifier">Mutable</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-189"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">VectorBuilder</span><span class="hs-operator">.</span><span class="hs-identifier">Builder</span><span>
</span><a name="line-190"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">VectorBuilder</span><span class="hs-operator">.</span><span class="hs-identifier">Vector</span><span>
</span><a name="line-191"></a><span>
</span><a name="line-192"></a><span class="hs-comment">{-| Efficient representation of a left fold that preserves the fold's step
    function, initial accumulator, and extraction function

    This allows the 'Applicative' instance to assemble derived folds that
    traverse the container only once

    A \''Fold' a b\' processes elements of type __a__ and results in a
    value of type __b__.
-}</span><span>
</span><a name="line-201"></a><span class="hs-keyword">data</span><span> </span><a name="Fold"><a href="Control.Foldl.html#Fold"><span class="hs-identifier">Fold</span></a></a><span> </span><a name="local-6989586621679052060"><a href="#local-6989586621679052060"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679052061"><a href="#local-6989586621679052061"><span class="hs-identifier">b</span></a></a><span>
</span><a name="line-202"></a><span>  </span><span class="hs-comment">-- | @Fold @ @ step @ @ initial @ @ extract@</span><span>
</span><a name="line-203"></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679052062"><a href="#local-6989586621679052062"><span class="hs-identifier">x</span></a></a><span class="hs-operator">.</span><span> </span><a name="Fold"><a href="Control.Foldl.html#Fold"><span class="hs-identifier">Fold</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052062"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052060"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052062"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679052062"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052062"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052061"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-keyword">data</span><span> </span><a name="Pair"><a href="Control.Foldl.html#Pair"><span class="hs-identifier">Pair</span></a></a><span> </span><a name="local-6989586621679052058"><a href="#local-6989586621679052058"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679052059"><a href="#local-6989586621679052059"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Pair"><a href="Control.Foldl.html#Pair"><span class="hs-identifier">Pair</span></a></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679052058"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679052059"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052286"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-208"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679052287"><a href="#local-6989586621679052287"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679052288"><a href="#local-6989586621679052288"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679052289"><a href="#local-6989586621679052289"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679052290"><a href="#local-6989586621679052290"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679052288"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679052289"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052287"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679052290"><span class="hs-identifier hs-var">done</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-pragma">{-# INLINE fmap #-}</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Profunctor</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-212"></a><span>    </span><a name="local-8214565720323795475"><span class="hs-identifier">lmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#premap"><span class="hs-identifier hs-var">premap</span></a><span>
</span><a name="line-213"></a><span>    </span><a name="local-8214565720323795474"><span class="hs-identifier">rmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span>
</span><a name="line-214"></a><span>
</span><a name="line-215"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Choice</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-216"></a><span>  </span><a name="local-8214565720323795284"><span class="hs-identifier">right'</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679052150"><a href="#local-6989586621679052150"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679052151"><a href="#local-6989586621679052151"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679052152"><a href="#local-6989586621679052152"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftA2</span><span> </span><a href="#local-6989586621679052150"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679052151"><span class="hs-identifier hs-var">begin</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679052152"><span class="hs-identifier hs-var">done</span></a><span class="hs-special">)</span><span>
</span><a name="line-217"></a><span>  </span><span class="hs-pragma">{-# INLINE right' #-}</span><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Comonad</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052143"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>    </span><a name="local-8214565720323791775"><span class="hs-identifier">extract</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679052144"><a href="#local-6989586621679052144"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679052145"><a href="#local-6989586621679052145"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679052145"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679052144"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-221"></a><span>    </span><span class="hs-pragma">{-#  INLINE extract #-}</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span>    </span><a name="local-8214565720323791774"><span class="hs-identifier">duplicate</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679052146"><a href="#local-6989586621679052146"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679052147"><a href="#local-6989586621679052147"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679052148"><a href="#local-6989586621679052148"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679052146"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679052147"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679052149"><a href="#local-6989586621679052149"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679052146"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679052149"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679052148"><span class="hs-identifier hs-var">done</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>    </span><span class="hs-pragma">{-#  INLINE duplicate #-}</span><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-227"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><a name="local-6989586621679052128"><a href="#local-6989586621679052128"><span class="hs-identifier">b</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052128"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-pragma">{-# INLINE pure #-}</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span>    </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679052129"><a href="#local-6989586621679052129"><span class="hs-identifier">stepL</span></a></a><span> </span><a name="local-6989586621679052130"><a href="#local-6989586621679052130"><span class="hs-identifier">beginL</span></a></a><span> </span><a name="local-6989586621679052131"><a href="#local-6989586621679052131"><span class="hs-identifier">doneL</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679052132"><a href="#local-6989586621679052132"><span class="hs-identifier">stepR</span></a></a><span> </span><a name="local-6989586621679052133"><a href="#local-6989586621679052133"><span class="hs-identifier">beginR</span></a></a><span> </span><a name="local-6989586621679052134"><a href="#local-6989586621679052134"><span class="hs-identifier">doneR</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-231"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679052135"><a href="#local-6989586621679052135"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679052138"><a href="#local-6989586621679052138"><span class="hs-identifier">xL</span></a></a><span> </span><a name="local-6989586621679052139"><a href="#local-6989586621679052139"><span class="hs-identifier">xR</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679052140"><a href="#local-6989586621679052140"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052129"><span class="hs-identifier hs-var">stepL</span></a><span> </span><a href="#local-6989586621679052138"><span class="hs-identifier hs-var">xL</span></a><span> </span><a href="#local-6989586621679052140"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052132"><span class="hs-identifier hs-var">stepR</span></a><span> </span><a href="#local-6989586621679052139"><span class="hs-identifier hs-var">xR</span></a><span> </span><a href="#local-6989586621679052140"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>            </span><a name="local-6989586621679052136"><a href="#local-6989586621679052136"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679052130"><span class="hs-identifier hs-var">beginL</span></a><span> </span><a href="#local-6989586621679052133"><span class="hs-identifier hs-var">beginR</span></a><span>
</span><a name="line-233"></a><span>            </span><a name="local-6989586621679052137"><a href="#local-6989586621679052137"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679052141"><a href="#local-6989586621679052141"><span class="hs-identifier">xL</span></a></a><span> </span><a name="local-6989586621679052142"><a href="#local-6989586621679052142"><span class="hs-identifier">xR</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679052131"><span class="hs-identifier hs-var">doneL</span></a><span> </span><a href="#local-6989586621679052141"><span class="hs-identifier hs-var">xL</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052134"><span class="hs-identifier hs-var">doneR</span></a><span> </span><a href="#local-6989586621679052142"><span class="hs-identifier hs-var">xR</span></a><span class="hs-special">)</span><span>
</span><a name="line-234"></a><span>        </span><span class="hs-keyword">in</span><span>  </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679052135"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679052136"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679052137"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;*&gt;) #-}</span><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679052125"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052126"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052125"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-identifier hs-var">mappend</span><span>
</span><a name="line-239"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;&gt;) #-}</span><span>
</span><a name="line-240"></a><span>
</span><a name="line-241"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679052123"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052124"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052123"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-242"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-pragma">{-# INLINE mempty #-}</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span>    </span><a name="local-3458764513820541484"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-246"></a><span>    </span><span class="hs-pragma">{-# INLINE mappend #-}</span><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679052121"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052122"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052121"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-249"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-pragma">{-# INLINE fromInteger #-}</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-253"></a><span>    </span><span class="hs-pragma">{-# INLINE negate #-}</span><span>
</span><a name="line-254"></a><span>
</span><a name="line-255"></a><span>    </span><a name="local-8214565720323790340"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">abs</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-pragma">{-# INLINE abs #-}</span><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span>    </span><a name="local-8214565720323790339"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">signum</span><span>
</span><a name="line-259"></a><span>    </span><span class="hs-pragma">{-# INLINE signum #-}</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790342"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-262"></a><span>    </span><span class="hs-pragma">{-# INLINE (+) #-}</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790341"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span>
</span><a name="line-265"></a><span>    </span><span class="hs-pragma">{-# INLINE (*) #-}</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-pragma">{-# INLINE (-) #-}</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679052119"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052120"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052119"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-271"></a><span>    </span><a name="local-3458764513820541090"><span class="hs-identifier">fromRational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-pragma">{-# INLINE fromRational #-}</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span>    </span><a name="local-8214565720323790234"><span class="hs-identifier">recip</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">recip</span><span>
</span><a name="line-275"></a><span>    </span><span class="hs-pragma">{-# INLINE recip #-}</span><span>
</span><a name="line-276"></a><span>
</span><a name="line-277"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790235"><span class="hs-operator">/</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><span class="hs-special">)</span><span>
</span><a name="line-278"></a><span>    </span><span class="hs-pragma">{-# INLINE (/) #-}</span><span>
</span><a name="line-279"></a><span>
</span><a name="line-280"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679052117"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052118"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052117"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-281"></a><span>    </span><a name="local-8214565720323790154"><span class="hs-identifier">pi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">pi</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-pragma">{-# INLINE pi #-}</span><span>
</span><a name="line-283"></a><span>
</span><a name="line-284"></a><span>    </span><a name="local-8214565720323790153"><span class="hs-identifier">exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">exp</span><span>
</span><a name="line-285"></a><span>    </span><span class="hs-pragma">{-# INLINE exp #-}</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span>    </span><a name="local-8214565720323790151"><span class="hs-identifier">sqrt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span>
</span><a name="line-288"></a><span>    </span><span class="hs-pragma">{-# INLINE sqrt #-}</span><span>
</span><a name="line-289"></a><span>
</span><a name="line-290"></a><span>    </span><a name="local-8214565720323790152"><span class="hs-identifier">log</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">log</span><span>
</span><a name="line-291"></a><span>    </span><span class="hs-pragma">{-# INLINE log #-}</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span>    </span><a name="local-8214565720323790148"><span class="hs-identifier">sin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sin</span><span>
</span><a name="line-294"></a><span>    </span><span class="hs-pragma">{-# INLINE sin #-}</span><span>
</span><a name="line-295"></a><span>
</span><a name="line-296"></a><span>    </span><a name="local-8214565720323790146"><span class="hs-identifier">tan</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">tan</span><span>
</span><a name="line-297"></a><span>    </span><span class="hs-pragma">{-# INLINE tan #-}</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span>    </span><a name="local-8214565720323790147"><span class="hs-identifier">cos</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">cos</span><span>
</span><a name="line-300"></a><span>    </span><span class="hs-pragma">{-# INLINE cos #-}</span><span>
</span><a name="line-301"></a><span>
</span><a name="line-302"></a><span>    </span><a name="local-8214565720323790145"><span class="hs-identifier">asin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">asin</span><span>
</span><a name="line-303"></a><span>    </span><span class="hs-pragma">{-# INLINE asin #-}</span><span>
</span><a name="line-304"></a><span>
</span><a name="line-305"></a><span>    </span><a name="local-8214565720323790143"><span class="hs-identifier">atan</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">atan</span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-pragma">{-# INLINE atan #-}</span><span>
</span><a name="line-307"></a><span>
</span><a name="line-308"></a><span>    </span><a name="local-8214565720323790144"><span class="hs-identifier">acos</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">acos</span><span>
</span><a name="line-309"></a><span>    </span><span class="hs-pragma">{-# INLINE acos #-}</span><span>
</span><a name="line-310"></a><span>
</span><a name="line-311"></a><span>    </span><a name="local-8214565720323790142"><span class="hs-identifier">sinh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sinh</span><span>
</span><a name="line-312"></a><span>    </span><span class="hs-pragma">{-# INLINE sinh #-}</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span>    </span><a name="local-8214565720323790140"><span class="hs-identifier">tanh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">tanh</span><span>
</span><a name="line-315"></a><span>    </span><span class="hs-pragma">{-# INLINE tanh #-}</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span>    </span><a name="local-8214565720323790141"><span class="hs-identifier">cosh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">cosh</span><span>
</span><a name="line-318"></a><span>    </span><span class="hs-pragma">{-# INLINE cosh #-}</span><span>
</span><a name="line-319"></a><span>
</span><a name="line-320"></a><span>    </span><a name="local-8214565720323790139"><span class="hs-identifier">asinh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">asinh</span><span>
</span><a name="line-321"></a><span>    </span><span class="hs-pragma">{-# INLINE asinh #-}</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span>    </span><a name="local-8214565720323790137"><span class="hs-identifier">atanh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">atanh</span><span>
</span><a name="line-324"></a><span>    </span><span class="hs-pragma">{-# INLINE atanh #-}</span><span>
</span><a name="line-325"></a><span>
</span><a name="line-326"></a><span>    </span><a name="local-8214565720323790138"><span class="hs-identifier">acosh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">acosh</span><span>
</span><a name="line-327"></a><span>    </span><span class="hs-pragma">{-# INLINE acosh #-}</span><span>
</span><a name="line-328"></a><span>
</span><a name="line-329"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790150"><span class="hs-operator">**</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">**</span><span class="hs-special">)</span><span>
</span><a name="line-330"></a><span>    </span><span class="hs-pragma">{-# INLINE (**) #-}</span><span>
</span><a name="line-331"></a><span>
</span><a name="line-332"></a><span>    </span><a name="local-8214565720323790149"><span class="hs-identifier">logBase</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-identifier hs-var">logBase</span><span>
</span><a name="line-333"></a><span>    </span><span class="hs-pragma">{-# INLINE logBase #-}</span><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-comment">{-| Like 'Fold', but monadic.

    A \''FoldM' m a b\' processes elements of type __a__ and
    results in a monadic value of type __m b__.
-}</span><span>
</span><a name="line-340"></a><span class="hs-keyword">data</span><span> </span><a name="FoldM"><a href="Control.Foldl.html#FoldM"><span class="hs-identifier">FoldM</span></a></a><span> </span><a name="local-6989586621679052054"><a href="#local-6989586621679052054"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679052055"><a href="#local-6989586621679052055"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679052056"><a href="#local-6989586621679052056"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-341"></a><span>  </span><span class="hs-comment">-- | @FoldM @ @ step @ @ initial @ @ extract@</span><span>
</span><a name="line-342"></a><span>  </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679052057"><a href="#local-6989586621679052057"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a name="FoldM"><a href="Control.Foldl.html#FoldM"><span class="hs-identifier">FoldM</span></a></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052057"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052055"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052054"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052057"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052054"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052057"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052057"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052054"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052056"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052108"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Functor</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052108"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052109"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-345"></a><span>    </span><a name="local-3458764513820541101"><span class="hs-identifier">fmap</span></a><span> </span><a name="local-6989586621679052110"><a href="#local-6989586621679052110"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679052111"><a href="#local-6989586621679052111"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679052112"><a href="#local-6989586621679052112"><span class="hs-identifier">start</span></a></a><span> </span><a name="local-6989586621679052113"><a href="#local-6989586621679052113"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679052111"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679052112"><span class="hs-identifier hs-var">start</span></a><span> </span><a href="#local-6989586621679052114"><span class="hs-identifier hs-var">done'</span></a><span>
</span><a name="line-346"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-347"></a><span>        </span><a name="local-6989586621679052114"><a href="#local-6989586621679052114"><span class="hs-identifier">done'</span></a></a><span> </span><a name="local-6989586621679052115"><a href="#local-6989586621679052115"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-348"></a><span>            </span><a name="local-6989586621679052116"><a href="#local-6989586621679052116"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052113"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679052115"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-349"></a><span>            </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679052110"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679052116"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-350"></a><span>    </span><span class="hs-pragma">{-# INLINE fmap #-}</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052085"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052085"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052086"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-353"></a><span>    </span><a name="local-3458764513820541680"><span class="hs-identifier">pure</span></a><span> </span><a name="local-6989586621679052087"><a href="#local-6989586621679052087"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679052087"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-354"></a><span>    </span><span class="hs-pragma">{-# INLINE pure #-}</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span>    </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679052088"><a href="#local-6989586621679052088"><span class="hs-identifier">stepL</span></a></a><span> </span><a name="local-6989586621679052089"><a href="#local-6989586621679052089"><span class="hs-identifier">beginL</span></a></a><span> </span><a name="local-6989586621679052090"><a href="#local-6989586621679052090"><span class="hs-identifier">doneL</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541679"><span class="hs-operator">&lt;*&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679052091"><a href="#local-6989586621679052091"><span class="hs-identifier">stepR</span></a></a><span> </span><a name="local-6989586621679052092"><a href="#local-6989586621679052092"><span class="hs-identifier">beginR</span></a></a><span> </span><a name="local-6989586621679052093"><a href="#local-6989586621679052093"><span class="hs-identifier">doneR</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-357"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679052094"><a href="#local-6989586621679052094"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679052097"><a href="#local-6989586621679052097"><span class="hs-identifier">xL</span></a></a><span> </span><a name="local-6989586621679052098"><a href="#local-6989586621679052098"><span class="hs-identifier">xR</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679052099"><a href="#local-6989586621679052099"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-358"></a><span>                </span><a name="local-6989586621679052100"><a href="#local-6989586621679052100"><span class="hs-identifier">xL'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052088"><span class="hs-identifier hs-var">stepL</span></a><span> </span><a href="#local-6989586621679052097"><span class="hs-identifier hs-var">xL</span></a><span> </span><a href="#local-6989586621679052099"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-359"></a><span>                </span><a name="local-6989586621679052101"><a href="#local-6989586621679052101"><span class="hs-identifier">xR'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052091"><span class="hs-identifier hs-var">stepR</span></a><span> </span><a href="#local-6989586621679052098"><span class="hs-identifier hs-var">xR</span></a><span> </span><a href="#local-6989586621679052099"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-360"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679052100"><span class="hs-identifier hs-var">xL'</span></a><span> </span><a href="#local-6989586621679052101"><span class="hs-identifier hs-var">xR'</span></a><span>
</span><a name="line-361"></a><span>            </span><a name="local-6989586621679052095"><a href="#local-6989586621679052095"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-362"></a><span>                </span><a name="local-6989586621679052102"><a href="#local-6989586621679052102"><span class="hs-identifier">xL</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052089"><span class="hs-identifier hs-var">beginL</span></a><span>
</span><a name="line-363"></a><span>                </span><a name="local-6989586621679052103"><a href="#local-6989586621679052103"><span class="hs-identifier">xR</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052092"><span class="hs-identifier hs-var">beginR</span></a><span>
</span><a name="line-364"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679052102"><span class="hs-identifier hs-var">xL</span></a><span> </span><a href="#local-6989586621679052103"><span class="hs-identifier hs-var">xR</span></a><span>
</span><a name="line-365"></a><span>            </span><a name="local-6989586621679052096"><a href="#local-6989586621679052096"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679052104"><a href="#local-6989586621679052104"><span class="hs-identifier">xL</span></a></a><span> </span><a name="local-6989586621679052105"><a href="#local-6989586621679052105"><span class="hs-identifier">xR</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-366"></a><span>                </span><a name="local-6989586621679052106"><a href="#local-6989586621679052106"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052090"><span class="hs-identifier hs-var">doneL</span></a><span> </span><a href="#local-6989586621679052104"><span class="hs-identifier hs-var">xL</span></a><span>
</span><a name="line-367"></a><span>                </span><a name="local-6989586621679052107"><a href="#local-6989586621679052107"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679052093"><span class="hs-identifier hs-var">doneR</span></a><span> </span><a href="#local-6989586621679052105"><span class="hs-identifier hs-var">xR</span></a><span>
</span><a name="line-368"></a><span>                </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679052106"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679052107"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-369"></a><span>        </span><span class="hs-keyword">in</span><span>  </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679052094"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679052095"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679052096"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-370"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;*&gt;) #-}</span><span>
</span><a name="line-371"></a><span>
</span><a name="line-372"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052084"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Profunctor</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052084"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-373"></a><span>    </span><a name="local-8214565720323795474"><span class="hs-identifier">rmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span>
</span><a name="line-374"></a><span>    </span><a name="local-8214565720323795475"><span class="hs-identifier">lmap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#premapM"><span class="hs-identifier hs-var">premapM</span></a><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679052081"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052082"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052082"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052083"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052081"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-377"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-identifier hs-var">mappend</span><span>
</span><a name="line-378"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;&gt;) #-}</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679052078"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052079"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052079"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052080"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052078"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-381"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-382"></a><span>    </span><span class="hs-pragma">{-# INLINE mempty #-}</span><span>
</span><a name="line-383"></a><span>
</span><a name="line-384"></a><span>    </span><a name="local-3458764513820541484"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-identifier hs-var">mappend</span><span>
</span><a name="line-385"></a><span>    </span><span class="hs-pragma">{-# INLINE mappend #-}</span><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052075"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679052076"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052075"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052077"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052076"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-388"></a><span>    </span><a name="local-3458764513820541088"><span class="hs-identifier">fromInteger</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span>
</span><a name="line-389"></a><span>    </span><span class="hs-pragma">{-# INLINE fromInteger #-}</span><span>
</span><a name="line-390"></a><span>
</span><a name="line-391"></a><span>    </span><a name="local-3458764513820541097"><span class="hs-identifier">negate</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">negate</span><span>
</span><a name="line-392"></a><span>    </span><span class="hs-pragma">{-# INLINE negate #-}</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span>    </span><a name="local-8214565720323790340"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">abs</span><span>
</span><a name="line-395"></a><span>    </span><span class="hs-pragma">{-# INLINE abs #-}</span><span>
</span><a name="line-396"></a><span>
</span><a name="line-397"></a><span>    </span><a name="local-8214565720323790339"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">signum</span><span>
</span><a name="line-398"></a><span>    </span><span class="hs-pragma">{-# INLINE signum #-}</span><span>
</span><a name="line-399"></a><span>
</span><a name="line-400"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790342"><span class="hs-operator">+</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>    </span><span class="hs-pragma">{-# INLINE (+) #-}</span><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790341"><span class="hs-operator">*</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span>
</span><a name="line-404"></a><span>    </span><span class="hs-pragma">{-# INLINE (*) #-}</span><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span>    </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><a name="line-407"></a><span>    </span><span class="hs-pragma">{-# INLINE (-) #-}</span><span>
</span><a name="line-408"></a><span>
</span><a name="line-409"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052072"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679052073"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052072"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052074"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052073"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-410"></a><span>    </span><a name="local-3458764513820541090"><span class="hs-identifier">fromRational</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span>
</span><a name="line-411"></a><span>    </span><span class="hs-pragma">{-# INLINE fromRational #-}</span><span>
</span><a name="line-412"></a><span>
</span><a name="line-413"></a><span>    </span><a name="local-8214565720323790234"><span class="hs-identifier">recip</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">recip</span><span>
</span><a name="line-414"></a><span>    </span><span class="hs-pragma">{-# INLINE recip #-}</span><span>
</span><a name="line-415"></a><span>
</span><a name="line-416"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790235"><span class="hs-operator">/</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">/</span><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span>    </span><span class="hs-pragma">{-# INLINE (/) #-}</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052069"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679052070"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679052069"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052071"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052070"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-420"></a><span>    </span><a name="local-8214565720323790154"><span class="hs-identifier">pi</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-identifier hs-var">pi</span><span>
</span><a name="line-421"></a><span>    </span><span class="hs-pragma">{-# INLINE pi #-}</span><span>
</span><a name="line-422"></a><span>
</span><a name="line-423"></a><span>    </span><a name="local-8214565720323790153"><span class="hs-identifier">exp</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">exp</span><span>
</span><a name="line-424"></a><span>    </span><span class="hs-pragma">{-# INLINE exp #-}</span><span>
</span><a name="line-425"></a><span>
</span><a name="line-426"></a><span>    </span><a name="local-8214565720323790151"><span class="hs-identifier">sqrt</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span>
</span><a name="line-427"></a><span>    </span><span class="hs-pragma">{-# INLINE sqrt #-}</span><span>
</span><a name="line-428"></a><span>
</span><a name="line-429"></a><span>    </span><a name="local-8214565720323790152"><span class="hs-identifier">log</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">log</span><span>
</span><a name="line-430"></a><span>    </span><span class="hs-pragma">{-# INLINE log #-}</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span>    </span><a name="local-8214565720323790148"><span class="hs-identifier">sin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sin</span><span>
</span><a name="line-433"></a><span>    </span><span class="hs-pragma">{-# INLINE sin #-}</span><span>
</span><a name="line-434"></a><span>
</span><a name="line-435"></a><span>    </span><a name="local-8214565720323790146"><span class="hs-identifier">tan</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">tan</span><span>
</span><a name="line-436"></a><span>    </span><span class="hs-pragma">{-# INLINE tan #-}</span><span>
</span><a name="line-437"></a><span>
</span><a name="line-438"></a><span>    </span><a name="local-8214565720323790147"><span class="hs-identifier">cos</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">cos</span><span>
</span><a name="line-439"></a><span>    </span><span class="hs-pragma">{-# INLINE cos #-}</span><span>
</span><a name="line-440"></a><span>
</span><a name="line-441"></a><span>    </span><a name="local-8214565720323790145"><span class="hs-identifier">asin</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">asin</span><span>
</span><a name="line-442"></a><span>    </span><span class="hs-pragma">{-# INLINE asin #-}</span><span>
</span><a name="line-443"></a><span>
</span><a name="line-444"></a><span>    </span><a name="local-8214565720323790143"><span class="hs-identifier">atan</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">atan</span><span>
</span><a name="line-445"></a><span>    </span><span class="hs-pragma">{-# INLINE atan #-}</span><span>
</span><a name="line-446"></a><span>
</span><a name="line-447"></a><span>    </span><a name="local-8214565720323790144"><span class="hs-identifier">acos</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">acos</span><span>
</span><a name="line-448"></a><span>    </span><span class="hs-pragma">{-# INLINE acos #-}</span><span>
</span><a name="line-449"></a><span>
</span><a name="line-450"></a><span>    </span><a name="local-8214565720323790142"><span class="hs-identifier">sinh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">sinh</span><span>
</span><a name="line-451"></a><span>    </span><span class="hs-pragma">{-# INLINE sinh #-}</span><span>
</span><a name="line-452"></a><span>
</span><a name="line-453"></a><span>    </span><a name="local-8214565720323790140"><span class="hs-identifier">tanh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">tanh</span><span>
</span><a name="line-454"></a><span>    </span><span class="hs-pragma">{-# INLINE tanh #-}</span><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span>    </span><a name="local-8214565720323790141"><span class="hs-identifier">cosh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">cosh</span><span>
</span><a name="line-457"></a><span>    </span><span class="hs-pragma">{-# INLINE cosh #-}</span><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span>    </span><a name="local-8214565720323790139"><span class="hs-identifier">asinh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">asinh</span><span>
</span><a name="line-460"></a><span>    </span><span class="hs-pragma">{-# INLINE asinh #-}</span><span>
</span><a name="line-461"></a><span>
</span><a name="line-462"></a><span>    </span><a name="local-8214565720323790137"><span class="hs-identifier">atanh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">atanh</span><span>
</span><a name="line-463"></a><span>    </span><span class="hs-pragma">{-# INLINE atanh #-}</span><span>
</span><a name="line-464"></a><span>
</span><a name="line-465"></a><span>    </span><a name="local-8214565720323790138"><span class="hs-identifier">acosh</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">acosh</span><span>
</span><a name="line-466"></a><span>    </span><span class="hs-pragma">{-# INLINE acosh #-}</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323790150"><span class="hs-operator">**</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">**</span><span class="hs-special">)</span><span>
</span><a name="line-469"></a><span>    </span><span class="hs-pragma">{-# INLINE (**) #-}</span><span>
</span><a name="line-470"></a><span>
</span><a name="line-471"></a><span>    </span><a name="local-8214565720323790149"><span class="hs-identifier">logBase</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftA2</span><span> </span><span class="hs-identifier hs-var">logBase</span><span>
</span><a name="line-472"></a><span>    </span><span class="hs-pragma">{-# INLINE logBase #-}</span><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-comment">-- | Apply a strict left 'Fold' to a 'Foldable' container</span><span>
</span><a name="line-475"></a><span class="hs-identifier">fold</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679057510"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057511"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057512"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057510"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679057511"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057512"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-476"></a><a name="fold"><a href="Control.Foldl.html#fold"><span class="hs-identifier">fold</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057513"><a href="#local-6989586621679057513"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057514"><a href="#local-6989586621679057514"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057515"><a href="#local-6989586621679057515"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679057517"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679057515"><span class="hs-identifier hs-var">done</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679057514"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-477"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-478"></a><span>    </span><a name="local-6989586621679057517"><a href="#local-6989586621679057517"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679057518"><a href="#local-6989586621679057518"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679057519"><a href="#local-6989586621679057519"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679057520"><a href="#local-6989586621679057520"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057519"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679057513"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057520"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057518"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-479"></a><span class="hs-pragma">{-# INLINE fold #-}</span><span>
</span><a name="line-480"></a><span>
</span><a name="line-481"></a><span class="hs-comment">-- | Like 'fold', but monadic</span><span>
</span><a name="line-482"></a><span class="hs-identifier">foldM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679057506"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679057507"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679057507"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679057508"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057509"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057506"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679057508"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057507"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679057509"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-483"></a><a name="foldM"><a href="Control.Foldl.html#foldM"><span class="hs-identifier">foldM</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057521"><a href="#local-6989586621679057521"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057522"><a href="#local-6989586621679057522"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057523"><a href="#local-6989586621679057523"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057524"><a href="#local-6989586621679057524"><span class="hs-identifier">as0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-484"></a><span>    </span><a name="local-6989586621679057530"><a href="#local-6989586621679057530"><span class="hs-identifier">x0</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679057522"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-485"></a><span>    </span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679057525"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057523"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057524"><span class="hs-identifier hs-var">as0</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679057530"><span class="hs-identifier hs-var">x0</span></a><span>
</span><a name="line-486"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-487"></a><span>    </span><a name="local-6989586621679057525"><a href="#local-6989586621679057525"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057526"><a href="#local-6989586621679057526"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679057527"><a href="#local-6989586621679057527"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679057528"><a href="#local-6989586621679057528"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-488"></a><span>        </span><a name="local-6989586621679057529"><a href="#local-6989586621679057529"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679057521"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057528"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057526"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-489"></a><span>        </span><a href="#local-6989586621679057527"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679057529"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-490"></a><span class="hs-pragma">{-# INLINE foldM #-}</span><span>
</span><a name="line-491"></a><span>
</span><a name="line-492"></a><span class="hs-comment">-- | Convert a strict left 'Fold' into a scan</span><span>
</span><a name="line-493"></a><span class="hs-identifier">scan</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057504"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057505"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057504"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057505"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-494"></a><a name="scan"><a href="Control.Foldl.html#scan"><span class="hs-identifier">scan</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057531"><a href="#local-6989586621679057531"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057532"><a href="#local-6989586621679057532"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057533"><a href="#local-6989586621679057533"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679057536"><span class="hs-identifier hs-var">cons</span></a><span> </span><a href="#local-6989586621679057535"><span class="hs-identifier hs-var">nil</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679057532"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-495"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-496"></a><span>    </span><a name="local-6989586621679057535"><a href="#local-6989586621679057535"><span class="hs-identifier">nil</span></a></a><span>      </span><a name="local-6989586621679057537"><a href="#local-6989586621679057537"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057533"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057537"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-497"></a><span>    </span><a name="local-6989586621679057536"><a href="#local-6989586621679057536"><span class="hs-identifier">cons</span></a></a><span> </span><a name="local-6989586621679057538"><a href="#local-6989586621679057538"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679057539"><a href="#local-6989586621679057539"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679057540"><a href="#local-6989586621679057540"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057533"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057540"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><span class="hs-special">(</span><a href="#local-6989586621679057539"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="#local-6989586621679057531"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057540"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057538"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-498"></a><span class="hs-pragma">{-# INLINE scan #-}</span><span>
</span><a name="line-499"></a><span>
</span><a name="line-500"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-501"></a><span class="hs-comment">{-| Convert a `Fold` into a prescan for any `Traversable` type

    \&quot;Prescan\&quot; means that the last element of the scan is not included
-}</span><span>
</span><a name="line-505"></a><span class="hs-identifier">prescan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-6989586621679057501"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057502"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057503"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057501"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679057502"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057501"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679057503"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-506"></a><a name="prescan"><a href="Control.Foldl.html#prescan"><span class="hs-identifier">prescan</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057541"><a href="#local-6989586621679057541"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057542"><a href="#local-6989586621679057542"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057543"><a href="#local-6989586621679057543"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057546"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-507"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-508"></a><span>    </span><a name="local-6989586621679057545"><a href="#local-6989586621679057545"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057547"><a href="#local-6989586621679057547"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057548"><a href="#local-6989586621679057548"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057549"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057550"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-509"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-510"></a><span>        </span><a name="local-6989586621679057549"><a href="#local-6989586621679057549"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057541"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057547"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057548"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-511"></a><span>        </span><a name="local-6989586621679057550"><a href="#local-6989586621679057550"><span class="hs-identifier">b</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057543"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057547"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-512"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679057546"><a href="#local-6989586621679057546"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapAccumL</span><span> </span><a href="#local-6989586621679057545"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057542"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-513"></a><span class="hs-pragma">{-# INLINE prescan #-}</span><span>
</span><a name="line-514"></a><span>
</span><a name="line-515"></a><span class="hs-comment">{-| Convert a `Fold` into a postscan for any `Traversable` type

    \&quot;Postscan\&quot; means that the first element of the scan is not included
-}</span><span>
</span><a name="line-519"></a><span class="hs-identifier">postscan</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><a href="#local-6989586621679057145"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057146"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057147"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057145"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679057146"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057145"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679057147"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-520"></a><a name="postscan"><a href="Control.Foldl.html#postscan"><span class="hs-identifier">postscan</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057551"><a href="#local-6989586621679057551"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057552"><a href="#local-6989586621679057552"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057553"><a href="#local-6989586621679057553"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057556"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-521"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-522"></a><span>    </span><a name="local-6989586621679057555"><a href="#local-6989586621679057555"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057557"><a href="#local-6989586621679057557"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057558"><a href="#local-6989586621679057558"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057559"><span class="hs-identifier hs-var">x'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057560"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-523"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-524"></a><span>        </span><a name="local-6989586621679057559"><a href="#local-6989586621679057559"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057551"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057557"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057558"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-525"></a><span>        </span><a name="local-6989586621679057560"><a href="#local-6989586621679057560"><span class="hs-identifier">b</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057553"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057559"><span class="hs-identifier hs-var">x'</span></a><span>
</span><a name="line-526"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679057556"><a href="#local-6989586621679057556"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapAccumL</span><span> </span><a href="#local-6989586621679057555"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057552"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-527"></a><span class="hs-pragma">{-# INLINE postscan #-}</span><span>
</span><a name="line-528"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-529"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-530"></a><span>
</span><a name="line-531"></a><span class="hs-comment">-- | Fold all values within a container using 'mappend' and 'mempty'</span><span>
</span><a name="line-532"></a><span class="hs-identifier">mconcat</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679057144"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057144"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057144"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-533"></a><a name="mconcat"><a href="Control.Foldl.html#mconcat"><span class="hs-identifier">mconcat</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-identifier hs-var">mappend</span><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-534"></a><span class="hs-pragma">{-# INLINABLE mconcat #-}</span><span>
</span><a name="line-535"></a><span>
</span><a name="line-536"></a><span class="hs-comment">-- | Convert a \&quot;@foldMap@\&quot; to a 'Fold'</span><span>
</span><a name="line-537"></a><span class="hs-identifier">foldMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679057141"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057142"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057141"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057141"><span class="hs-identifier hs-type">w</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057143"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057142"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057143"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-538"></a><a name="foldMap"><a href="Control.Foldl.html#foldMap"><span class="hs-identifier">foldMap</span></a></a><span> </span><a name="local-6989586621679057561"><a href="#local-6989586621679057561"><span class="hs-identifier">to</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057562"><a href="#local-6989586621679057562"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057563"><a href="#local-6989586621679057563"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mappend</span><span> </span><a href="#local-6989586621679057562"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057561"><span class="hs-identifier hs-var">to</span></a><span> </span><a href="#local-6989586621679057563"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-539"></a><span class="hs-pragma">{-# INLINABLE foldMap #-}</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-comment">{-| Get the first element of a container or return 'Nothing' if the container is
    empty
-}</span><span>
</span><a name="line-544"></a><span class="hs-identifier">head</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057140"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057140"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-545"></a><a name="head"><a href="Control.Foldl.html#head"><span class="hs-identifier">head</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span> </span><span class="hs-identifier hs-var">const</span><span>
</span><a name="line-546"></a><span class="hs-pragma">{-# INLINABLE head #-}</span><span>
</span><a name="line-547"></a><span>
</span><a name="line-548"></a><span class="hs-comment">{-| Get the last element of a container or return 'Nothing' if the container is
    empty
-}</span><span>
</span><a name="line-551"></a><span class="hs-identifier">last</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057139"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057139"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-552"></a><a name="last"><a href="Control.Foldl.html#last"><span class="hs-identifier">last</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">const</span><span class="hs-special">)</span><span>
</span><a name="line-553"></a><span class="hs-pragma">{-# INLINABLE last #-}</span><span>
</span><a name="line-554"></a><span>
</span><a name="line-555"></a><span class="hs-comment">{-| Get the last element of a container or return a default value if the container
    is empty
-}</span><span>
</span><a name="line-558"></a><span class="hs-identifier">lastDef</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679057138"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057138"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057138"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-559"></a><a name="lastDef"><a href="Control.Foldl.html#lastDef"><span class="hs-identifier">lastDef</span></a></a><span> </span><a name="local-6989586621679057564"><a href="#local-6989586621679057564"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679057565"><a href="#local-6989586621679057565"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057565"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057564"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-560"></a><span class="hs-pragma">{-# INLINABLE lastDef #-}</span><span>
</span><a name="line-561"></a><span>
</span><a name="line-562"></a><span class="hs-comment">{-| Return the last N elements

-}</span><span>
</span><a name="line-565"></a><span class="hs-identifier">lastN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057137"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057137"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-566"></a><a name="lastN"><a href="Control.Foldl.html#lastN"><span class="hs-identifier">lastN</span></a></a><span> </span><a name="local-6989586621679057566"><a href="#local-6989586621679057566"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057567"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057568"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057569"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-567"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-568"></a><span>    </span><a name="local-6989586621679057567"><a href="#local-6989586621679057567"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057570"><a href="#local-6989586621679057570"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679057571"><a href="#local-6989586621679057571"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057572"><span class="hs-identifier hs-var">s'</span></a><span> </span><span class="hs-operator hs-var">|&gt;</span><span> </span><a href="#local-6989586621679057571"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-569"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-570"></a><span>        </span><a name="local-6989586621679057572"><a href="#local-6989586621679057572"><span class="hs-identifier">s'</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-571"></a><span>            </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">Seq</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679057570"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679057566"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-572"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679057570"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-573"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Seq</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679057570"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-574"></a><span>    </span><a name="local-6989586621679057568"><a href="#local-6989586621679057568"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Seq</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-575"></a><span>    </span><a name="local-6989586621679057569"><a href="#local-6989586621679057569"><span class="hs-identifier">done</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span>
</span><a name="line-576"></a><span class="hs-pragma">{-# INLINABLE lastN #-}</span><span>
</span><a name="line-577"></a><span>
</span><a name="line-578"></a><span class="hs-comment">-- | Returns 'True' if the container is empty, 'False' otherwise</span><span>
</span><a name="line-579"></a><span class="hs-identifier">null</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057136"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-580"></a><a name="null"><a href="Control.Foldl.html#null"><span class="hs-identifier">null</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-581"></a><span class="hs-pragma">{-# INLINABLE null #-}</span><span>
</span><a name="line-582"></a><span>
</span><a name="line-583"></a><span class="hs-comment">-- | Return the length of the container</span><span>
</span><a name="line-584"></a><span class="hs-identifier">length</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057135"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-585"></a><a name="length"><a href="Control.Foldl.html#length"><span class="hs-identifier">length</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#genericLength"><span class="hs-identifier hs-var">genericLength</span></a><span>
</span><a name="line-586"></a><span class="hs-comment">{- Technically, 'length' is just 'genericLength' specialized to 'Int's.  I keep
   the two separate so that I can later provide an 'Int'-specialized
   implementation of 'length' for performance reasons like &quot;GHC.List&quot; does
   without breaking backwards compatibility.
-}</span><span>
</span><a name="line-591"></a><span class="hs-pragma">{-# INLINABLE length #-}</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-comment">-- | Returns 'True' if all elements are 'True', 'False' otherwise</span><span>
</span><a name="line-594"></a><span class="hs-identifier">and</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-595"></a><a name="and"><a href="Control.Foldl.html#and"><span class="hs-identifier">and</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-596"></a><span class="hs-pragma">{-# INLINABLE and #-}</span><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-comment">-- | Returns 'True' if any element is 'True', 'False' otherwise</span><span>
</span><a name="line-599"></a><span class="hs-identifier">or</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-600"></a><a name="or"><a href="Control.Foldl.html#or"><span class="hs-identifier">or</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">||</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-601"></a><span class="hs-pragma">{-# INLINABLE or #-}</span><span>
</span><a name="line-602"></a><span>
</span><a name="line-603"></a><span class="hs-comment">{-| @(all predicate)@ returns 'True' if all elements satisfy the predicate,
    'False' otherwise
-}</span><span>
</span><a name="line-606"></a><span class="hs-identifier">all</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057134"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057134"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-607"></a><a name="all"><a href="Control.Foldl.html#all"><span class="hs-identifier">all</span></a></a><span> </span><a name="local-6989586621679057573"><a href="#local-6989586621679057573"><span class="hs-identifier">predicate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057574"><a href="#local-6989586621679057574"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057575"><a href="#local-6989586621679057575"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057574"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679057573"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679057575"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-608"></a><span class="hs-pragma">{-# INLINABLE all #-}</span><span>
</span><a name="line-609"></a><span>
</span><a name="line-610"></a><span class="hs-comment">{-| @(any predicate)@ returns 'True' if any element satisfies the predicate,
    'False' otherwise
-}</span><span>
</span><a name="line-613"></a><span class="hs-identifier">any</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057133"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057133"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-614"></a><a name="any"><a href="Control.Foldl.html#any"><span class="hs-identifier">any</span></a></a><span> </span><a name="local-6989586621679057576"><a href="#local-6989586621679057576"><span class="hs-identifier">predicate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057577"><a href="#local-6989586621679057577"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057578"><a href="#local-6989586621679057578"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057577"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679057576"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679057578"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-615"></a><span class="hs-pragma">{-# INLINABLE any #-}</span><span>
</span><a name="line-616"></a><span>
</span><a name="line-617"></a><span class="hs-comment">-- | Computes the sum of all elements</span><span>
</span><a name="line-618"></a><span class="hs-identifier">sum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679057132"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057132"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057132"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-619"></a><a name="sum"><a href="Control.Foldl.html#sum"><span class="hs-identifier">sum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-620"></a><span class="hs-pragma">{-# INLINABLE sum #-}</span><span>
</span><a name="line-621"></a><span>
</span><a name="line-622"></a><span class="hs-comment">-- | Computes the product of all elements</span><span>
</span><a name="line-623"></a><span class="hs-identifier">product</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679057131"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057131"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057131"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-624"></a><a name="product"><a href="Control.Foldl.html#product"><span class="hs-identifier">product</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">*</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-625"></a><span class="hs-pragma">{-# INLINABLE product #-}</span><span>
</span><a name="line-626"></a><span>
</span><a name="line-627"></a><span class="hs-comment">-- | Compute a numerically stable arithmetic mean of all elements</span><span>
</span><a name="line-628"></a><span class="hs-identifier">mean</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679057130"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057130"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057130"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-629"></a><a name="mean"><a href="Control.Foldl.html#mean"><span class="hs-identifier">mean</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057580"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057579"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057581"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-630"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-631"></a><span>    </span><a name="local-6989586621679057579"><a href="#local-6989586621679057579"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-632"></a><span>    </span><a name="local-6989586621679057580"><a href="#local-6989586621679057580"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679057582"><a href="#local-6989586621679057582"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057583"><a href="#local-6989586621679057583"><span class="hs-identifier">n</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057584"><a href="#local-6989586621679057584"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679057582"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679057583"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679057584"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057583"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057583"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-633"></a><span>    </span><a name="local-6989586621679057581"><a href="#local-6989586621679057581"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679057585"><a href="#local-6989586621679057585"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057585"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-634"></a><span class="hs-pragma">{-# INLINABLE mean #-}</span><span>
</span><a name="line-635"></a><span>
</span><a name="line-636"></a><span class="hs-comment">-- | Compute a numerically stable (population) variance over all elements</span><span>
</span><a name="line-637"></a><span class="hs-identifier">variance</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679057129"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057129"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057129"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-638"></a><a name="variance"><a href="Control.Foldl.html#variance"><span class="hs-identifier">variance</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057587"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057586"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057588"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-639"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-640"></a><span>    </span><a name="local-6989586621679057586"><a href="#local-6989586621679057586"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-641"></a><span>
</span><a name="line-642"></a><span>    </span><a name="local-6989586621679057587"><a href="#local-6989586621679057587"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a name="local-6989586621679057589"><a href="#local-6989586621679057589"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679057590"><a href="#local-6989586621679057590"><span class="hs-identifier">mean_</span></a></a><span> </span><a name="local-6989586621679057591"><a href="#local-6989586621679057591"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057592"><a href="#local-6989586621679057592"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a href="#local-6989586621679057593"><span class="hs-identifier hs-var">n'</span></a><span> </span><a href="#local-6989586621679057594"><span class="hs-identifier hs-var">mean'</span></a><span> </span><a href="#local-6989586621679057596"><span class="hs-identifier hs-var">m2'</span></a><span>
</span><a name="line-643"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-644"></a><span>        </span><a name="local-6989586621679057593"><a href="#local-6989586621679057593"><span class="hs-identifier">n'</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057589"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-645"></a><span>        </span><a name="local-6989586621679057594"><a href="#local-6989586621679057594"><span class="hs-identifier">mean'</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057589"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679057590"><span class="hs-identifier hs-var">mean_</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679057592"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057589"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-646"></a><span>        </span><a name="local-6989586621679057595"><a href="#local-6989586621679057595"><span class="hs-identifier">delta</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057592"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679057590"><span class="hs-identifier hs-var">mean_</span></a><span>
</span><a name="line-647"></a><span>        </span><a name="local-6989586621679057596"><a href="#local-6989586621679057596"><span class="hs-identifier">m2'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057591"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679057595"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679057595"><span class="hs-identifier hs-var">delta</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679057589"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057589"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-648"></a><span>
</span><a name="line-649"></a><span>    </span><a name="local-6989586621679057588"><a href="#local-6989586621679057588"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a name="local-6989586621679057597"><a href="#local-6989586621679057597"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679057598"><a href="#local-6989586621679057598"><span class="hs-identifier">m2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057598"><span class="hs-identifier hs-var">m2</span></a><span> </span><span class="hs-operator hs-var">/</span><span> </span><a href="#local-6989586621679057597"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-650"></a><span class="hs-pragma">{-# INLINABLE variance #-}</span><span>
</span><a name="line-651"></a><span>
</span><a name="line-652"></a><span class="hs-comment">{-| Compute a numerically stable (population) standard deviation over all
    elements
-}</span><span>
</span><a name="line-655"></a><span class="hs-identifier">std</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679057128"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057128"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057128"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-656"></a><a name="std"><a href="Control.Foldl.html#std"><span class="hs-identifier">std</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sqrt</span><span> </span><a href="Control.Foldl.html#variance"><span class="hs-identifier hs-var">variance</span></a><span>
</span><a name="line-657"></a><span class="hs-pragma">{-# INLINABLE std #-}</span><span>
</span><a name="line-658"></a><span>
</span><a name="line-659"></a><span class="hs-comment">-- | Computes the maximum element</span><span>
</span><a name="line-660"></a><span class="hs-identifier">maximum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679057127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057127"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057127"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-661"></a><a name="maximum"><a href="Control.Foldl.html#maximum"><span class="hs-identifier">maximum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span> </span><span class="hs-identifier hs-var">max</span><span>
</span><a name="line-662"></a><span class="hs-pragma">{-# INLINABLE maximum #-}</span><span>
</span><a name="line-663"></a><span>
</span><a name="line-664"></a><span class="hs-comment">{-| Computes the maximum element with respect to the given comparison
    function
-}</span><span>
</span><a name="line-667"></a><span class="hs-identifier">maximumBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057126"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057126"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057126"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057126"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-668"></a><a name="maximumBy"><a href="Control.Foldl.html#maximumBy"><span class="hs-identifier">maximumBy</span></a></a><span> </span><a name="local-6989586621679057599"><a href="#local-6989586621679057599"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span> </span><a href="#local-6989586621679057600"><span class="hs-identifier hs-var">max'</span></a><span>
</span><a name="line-669"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-670"></a><span>    </span><a name="local-6989586621679057600"><a href="#local-6989586621679057600"><span class="hs-identifier">max'</span></a></a><span> </span><a name="local-6989586621679057601"><a href="#local-6989586621679057601"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057602"><a href="#local-6989586621679057602"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057599"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679057601"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057602"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-671"></a><span>        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057601"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-672"></a><span>        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057602"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-673"></a><span class="hs-pragma">{-# INLINABLE maximumBy #-}</span><span>
</span><a name="line-674"></a><span>
</span><a name="line-675"></a><span class="hs-comment">-- | Computes the minimum element</span><span>
</span><a name="line-676"></a><span class="hs-identifier">minimum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679057125"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057125"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057125"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-677"></a><a name="minimum"><a href="Control.Foldl.html#minimum"><span class="hs-identifier">minimum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span> </span><span class="hs-identifier hs-var">min</span><span>
</span><a name="line-678"></a><span class="hs-pragma">{-# INLINABLE minimum #-}</span><span>
</span><a name="line-679"></a><span>
</span><a name="line-680"></a><span class="hs-comment">{-| Computes the minimum element with respect to the given comparison
    function
-}</span><span>
</span><a name="line-683"></a><span class="hs-identifier">minimumBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057124"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057124"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-684"></a><a name="minimumBy"><a href="Control.Foldl.html#minimumBy"><span class="hs-identifier">minimumBy</span></a></a><span> </span><a name="local-6989586621679057603"><a href="#local-6989586621679057603"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier hs-var">_Fold1</span></a><span> </span><a href="#local-6989586621679057604"><span class="hs-identifier hs-var">min'</span></a><span>
</span><a name="line-685"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-686"></a><span>    </span><a name="local-6989586621679057604"><a href="#local-6989586621679057604"><span class="hs-identifier">min'</span></a></a><span> </span><a name="local-6989586621679057605"><a href="#local-6989586621679057605"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057606"><a href="#local-6989586621679057606"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057603"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679057605"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057606"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-687"></a><span>        </span><span class="hs-identifier hs-var">GT</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057606"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-688"></a><span>        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057605"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-689"></a><span class="hs-pragma">{-# INLINABLE minimumBy #-}</span><span>
</span><a name="line-690"></a><span>
</span><a name="line-691"></a><span class="hs-comment">{-| @(elem a)@ returns 'True' if the container has an element equal to @a@,
    'False' otherwise
-}</span><span>
</span><a name="line-694"></a><span class="hs-identifier">elem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057123"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057123"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057123"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-695"></a><a name="elem"><a href="Control.Foldl.html#elem"><span class="hs-identifier">elem</span></a></a><span> </span><a name="local-6989586621679057607"><a href="#local-6989586621679057607"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#any"><span class="hs-identifier hs-var">any</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057607"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-696"></a><span class="hs-pragma">{-# INLINABLE elem #-}</span><span>
</span><a name="line-697"></a><span>
</span><a name="line-698"></a><span class="hs-comment">{-| @(notElem a)@ returns 'False' if the container has an element equal to @a@,
    'True' otherwise
-}</span><span>
</span><a name="line-701"></a><span class="hs-identifier">notElem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057122"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-702"></a><a name="notElem"><a href="Control.Foldl.html#notElem"><span class="hs-identifier">notElem</span></a></a><span> </span><a name="local-6989586621679057608"><a href="#local-6989586621679057608"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#all"><span class="hs-identifier hs-var">all</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057608"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">/=</span><span class="hs-special">)</span><span>
</span><a name="line-703"></a><span class="hs-pragma">{-# INLINABLE notElem #-}</span><span>
</span><a name="line-704"></a><span>
</span><a name="line-705"></a><span class="hs-comment">{-| @(find predicate)@ returns the first element that satisfies the predicate or
    'Nothing' if no element satisfies the predicate
-}</span><span>
</span><a name="line-708"></a><span class="hs-identifier">find</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057121"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057121"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-709"></a><a name="find"><a href="Control.Foldl.html#find"><span class="hs-identifier">find</span></a></a><span> </span><a name="local-6989586621679057609"><a href="#local-6989586621679057609"><span class="hs-identifier">predicate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057610"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><a href="Control.Foldl.Internal.html#lazy"><span class="hs-identifier hs-var">lazy</span></a><span>
</span><a name="line-710"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-711"></a><span>    </span><a name="local-6989586621679057610"><a href="#local-6989586621679057610"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057611"><a href="#local-6989586621679057611"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057612"><a href="#local-6989586621679057612"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057611"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-712"></a><span>        </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057609"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679057612"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><a href="#local-6989586621679057612"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span>
</span><a name="line-713"></a><span>        </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057611"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-714"></a><span class="hs-pragma">{-# INLINABLE find #-}</span><span>
</span><a name="line-715"></a><span>
</span><a name="line-716"></a><span class="hs-comment">{-| @(index n)@ returns the @n@th element of the container, or 'Nothing' if the
    container has an insufficient number of elements
-}</span><span>
</span><a name="line-719"></a><span class="hs-identifier">index</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057120"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057120"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-720"></a><a name="index"><a href="Control.Foldl.html#index"><span class="hs-identifier">index</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#genericIndex"><span class="hs-identifier hs-var">genericIndex</span></a><span>
</span><a name="line-721"></a><span class="hs-pragma">{-# INLINABLE index #-}</span><span>
</span><a name="line-722"></a><span>
</span><a name="line-723"></a><span class="hs-comment">{-| @(elemIndex a)@ returns the index of the first element that equals @a@, or
    'Nothing' if no element matches
-}</span><span>
</span><a name="line-726"></a><span class="hs-identifier">elemIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057119"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-727"></a><a name="elemIndex"><a href="Control.Foldl.html#elemIndex"><span class="hs-identifier">elemIndex</span></a></a><span> </span><a name="local-6989586621679057613"><a href="#local-6989586621679057613"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#findIndex"><span class="hs-identifier hs-var">findIndex</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057613"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-728"></a><span class="hs-pragma">{-# INLINABLE elemIndex #-}</span><span>
</span><a name="line-729"></a><span>
</span><a name="line-730"></a><span class="hs-comment">{-| @(findIndex predicate)@ returns the index of the first element that
    satisfies the predicate, or 'Nothing' if no element satisfies the predicate
-}</span><span>
</span><a name="line-733"></a><span class="hs-identifier">findIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057118"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-734"></a><a name="findIndex"><a href="Control.Foldl.html#findIndex"><span class="hs-identifier">findIndex</span></a></a><span> </span><a name="local-6989586621679057614"><a href="#local-6989586621679057614"><span class="hs-identifier">predicate</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057615"><span class="hs-identifier hs-var">step</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="Control.Foldl.Internal.html#hush"><span class="hs-identifier hs-var">hush</span></a><span>
</span><a name="line-735"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-736"></a><span>    </span><a name="local-6989586621679057615"><a href="#local-6989586621679057615"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057616"><a href="#local-6989586621679057616"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057617"><a href="#local-6989586621679057617"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057616"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-737"></a><span>        </span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span> </span><a name="local-6989586621679057618"><a href="#local-6989586621679057618"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-738"></a><span>            </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057614"><span class="hs-identifier hs-var">predicate</span></a><span> </span><a href="#local-6989586621679057617"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-739"></a><span>            </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.Internal.html#Right%27"><span class="hs-identifier hs-var">Right'</span></a><span> </span><a href="#local-6989586621679057618"><span class="hs-identifier hs-var">i</span></a><span>
</span><a name="line-740"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057618"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-741"></a><span>        </span><span class="hs-identifier">_</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057616"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-742"></a><span class="hs-pragma">{-# INLINABLE findIndex #-}</span><span>
</span><a name="line-743"></a><span>
</span><a name="line-744"></a><span>
</span><a name="line-745"></a><span class="hs-comment">{-| @(lookup a)@ returns the element paired with the first matching item, or
    'Nothing' if none matches
-}</span><span>
</span><a name="line-748"></a><span class="hs-identifier">lookup</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057116"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057116"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057116"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="#local-6989586621679057117"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057117"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-749"></a><a name="lookup"><a href="Control.Foldl.html#lookup"><span class="hs-identifier">lookup</span></a></a><span> </span><a name="local-6989586621679057619"><a href="#local-6989586621679057619"><span class="hs-identifier">a0</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057620"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><a href="Control.Foldl.Internal.html#lazy"><span class="hs-identifier hs-var">lazy</span></a><span>
</span><a name="line-750"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-751"></a><span>    </span><a name="local-6989586621679057620"><a href="#local-6989586621679057620"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057621"><a href="#local-6989586621679057621"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679057622"><a href="#local-6989586621679057622"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679057623"><a href="#local-6989586621679057623"><span class="hs-identifier">b</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057621"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-752"></a><span>      </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057622"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679057619"><span class="hs-identifier hs-var">a0</span></a><span>
</span><a name="line-753"></a><span>        </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><a href="#local-6989586621679057623"><span class="hs-identifier hs-var">b</span></a><span>
</span><a name="line-754"></a><span>        </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span>
</span><a name="line-755"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057621"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-756"></a><span class="hs-pragma">{-# INLINABLE lookup #-}</span><span>
</span><a name="line-757"></a><span>
</span><a name="line-758"></a><span class="hs-keyword">data</span><span> </span><a name="Pair3"><a href="Control.Foldl.html#Pair3"><span class="hs-identifier">Pair3</span></a></a><span> </span><a name="local-6989586621679052051"><a href="#local-6989586621679052051"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679052052"><a href="#local-6989586621679052052"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679052053"><a href="#local-6989586621679052053"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Pair3"><a href="Control.Foldl.html#Pair3"><span class="hs-identifier">Pair3</span></a></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679052051"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679052052"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">!</span><a href="#local-6989586621679052053"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-759"></a><span>
</span><a name="line-760"></a><span class="hs-comment">-- | Pick a random element, using reservoir sampling</span><span>
</span><a name="line-761"></a><span class="hs-identifier">random</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679057115"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057115"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-762"></a><a name="random"><a href="Control.Foldl.html#random"><span class="hs-identifier">random</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057625"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057624"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057626"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-763"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-764"></a><span>    </span><a name="local-6989586621679057624"><a href="#local-6989586621679057624"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-765"></a><span>        </span><a name="local-6989586621679057627"><a href="#local-6989586621679057627"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">createSystemRandom</span><span>
</span><a name="line-766"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a href="#local-6989586621679057627"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span>
</span><a name="line-767"></a><span>
</span><a name="line-768"></a><span>    </span><a name="local-6989586621679057625"><a href="#local-6989586621679057625"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a name="local-6989586621679057628"><a href="#local-6989586621679057628"><span class="hs-identifier">g</span></a></a><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span>  </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679057629"><a href="#local-6989586621679057629"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a href="#local-6989586621679057628"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><a href="#local-6989586621679057629"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-number">2</span><span>
</span><a name="line-769"></a><span>    </span><span class="hs-identifier">step</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a name="local-6989586621679057630"><a href="#local-6989586621679057630"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><a name="local-6989586621679057631"><a href="#local-6989586621679057631"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057632"><a href="#local-6989586621679057632"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057633"><a href="#local-6989586621679057633"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-770"></a><span>        </span><a name="local-6989586621679057634"><a href="#local-6989586621679057634"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">uniformR</span><span> </span><span class="hs-special">(</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057632"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057630"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-771"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057635"><a href="#local-6989586621679057635"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057634"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679057633"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679057631"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-772"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><a href="#local-6989586621679057630"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><a href="#local-6989586621679057635"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057632"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-773"></a><span>
</span><a name="line-774"></a><span>    </span><a name="local-6989586621679057626"><a href="#local-6989586621679057626"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair3"><span class="hs-identifier hs-var">Pair3</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679057636"><a href="#local-6989586621679057636"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#lazy"><span class="hs-identifier hs-var">lazy</span></a><span> </span><a href="#local-6989586621679057636"><span class="hs-identifier hs-var">ma</span></a><span class="hs-special">)</span><span>
</span><a name="line-775"></a><span class="hs-pragma">{-# INLINABLE random #-}</span><span>
</span><a name="line-776"></a><span>
</span><a name="line-777"></a><span class="hs-keyword">data</span><span> </span><a name="VectorState"><a href="Control.Foldl.html#VectorState"><span class="hs-identifier">VectorState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Incomplete"><a href="Control.Foldl.html#Incomplete"><span class="hs-identifier">Incomplete</span></a></a><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">|</span><span> </span><a name="Complete"><a href="Control.Foldl.html#Complete"><span class="hs-identifier">Complete</span></a></a><span>
</span><a name="line-778"></a><span>
</span><a name="line-779"></a><span class="hs-keyword">data</span><span> </span><a name="RandomNState"><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier">RandomNState</span></a></a><span> </span><a name="local-6989586621679052049"><a href="#local-6989586621679052049"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679052050"><a href="#local-6989586621679052050"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RandomNState"><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier">RandomNState</span></a></a><span>
</span><a name="line-780"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="_size"><a href="Control.Foldl.html#_size"><span class="hs-identifier">_size</span></a></a><span>      </span><span class="hs-glyph">::</span><span>                </span><span class="hs-glyph">!</span><a href="Control.Foldl.html#VectorState"><span class="hs-identifier hs-type">VectorState</span></a><span>
</span><a name="line-781"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_reservoir"><a href="Control.Foldl.html#_reservoir"><span class="hs-identifier">_reservoir</span></a></a><span> </span><span class="hs-glyph">::</span><span>                </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Mutable</span><span> </span><a href="#local-6989586621679052049"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-identifier hs-type">RealWorld</span><span> </span><a href="#local-6989586621679052050"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-782"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_position"><a href="Control.Foldl.html#_position"><span class="hs-identifier">_position</span></a></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-783"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="_gen"><a href="Control.Foldl.html#_gen"><span class="hs-identifier">_gen</span></a></a><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK #-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-identifier hs-type">GenIO</span><span>
</span><a name="line-784"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-785"></a><span>
</span><a name="line-786"></a><span class="hs-comment">-- | Pick several random elements, using reservoir sampling</span><span>
</span><a name="line-787"></a><span class="hs-identifier">randomN</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679057113"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679057114"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057113"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057114"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-788"></a><a name="randomN"><a href="Control.Foldl.html#randomN"><span class="hs-identifier">randomN</span></a></a><span> </span><a name="local-6989586621679057637"><a href="#local-6989586621679057637"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057638"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057639"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057640"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-789"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-790"></a><span>    </span><span class="hs-identifier">step</span><span>
</span><a name="line-791"></a><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">MVector</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Mutable</span><span> </span><a href="#local-6989586621679057641"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057642"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-792"></a><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-type">RandomNState</span></a><span> </span><a href="#local-6989586621679057641"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057642"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057642"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-type">RandomNState</span></a><span> </span><a href="#local-6989586621679057641"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057642"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-793"></a><span>    </span><a name="local-6989586621679057638"><a href="#local-6989586621679057638"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Incomplete"><span class="hs-identifier hs-var">Incomplete</span></a><span> </span><a name="local-6989586621679057678"><a href="#local-6989586621679057678"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057679"><a href="#local-6989586621679057679"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679057680"><a href="#local-6989586621679057680"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679057681"><a href="#local-6989586621679057681"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057682"><a href="#local-6989586621679057682"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-794"></a><span>        </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">write</span><span> </span><a href="#local-6989586621679057679"><span class="hs-identifier hs-var">mv</span></a><span> </span><a href="#local-6989586621679057678"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679057682"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-795"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057683"><a href="#local-6989586621679057683"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057678"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-796"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057684"><a href="#local-6989586621679057684"><span class="hs-identifier">s</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057637"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><a href="#local-6989586621679057683"><span class="hs-identifier hs-var">m'</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.html#Complete"><span class="hs-identifier hs-var">Complete</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.html#Incomplete"><span class="hs-identifier hs-var">Incomplete</span></a><span> </span><a href="#local-6989586621679057683"><span class="hs-identifier hs-var">m'</span></a><span>
</span><a name="line-797"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span> </span><a href="#local-6989586621679057684"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679057679"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057680"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057681"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-798"></a><span>    </span><span class="hs-identifier">step</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span>  </span><a href="Control.Foldl.html#Complete"><span class="hs-identifier hs-var">Complete</span></a><span>      </span><a name="local-6989586621679057685"><a href="#local-6989586621679057685"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679057686"><a href="#local-6989586621679057686"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679057687"><a href="#local-6989586621679057687"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057688"><a href="#local-6989586621679057688"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-799"></a><span>        </span><a name="local-6989586621679057689"><a href="#local-6989586621679057689"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">uniformR</span><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057686"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057687"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-800"></a><span>        </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057689"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679057637"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-801"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeWrite</span><span> </span><a href="#local-6989586621679057685"><span class="hs-identifier hs-var">mv</span></a><span> </span><a href="#local-6989586621679057689"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679057688"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-802"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-803"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span> </span><a href="Control.Foldl.html#Complete"><span class="hs-identifier hs-var">Complete</span></a><span> </span><a href="#local-6989586621679057685"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057686"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057687"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-804"></a><span>
</span><a name="line-805"></a><span>    </span><a name="local-6989586621679057639"><a href="#local-6989586621679057639"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-806"></a><span>        </span><a name="local-6989586621679057690"><a href="#local-6989586621679057690"><span class="hs-identifier">mv</span></a></a><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">new</span><span> </span><a href="#local-6989586621679057637"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-807"></a><span>        </span><a name="local-6989586621679057691"><a href="#local-6989586621679057691"><span class="hs-identifier">gen</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">createSystemRandom</span><span>
</span><a name="line-808"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057692"><a href="#local-6989586621679057692"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057637"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.html#Complete"><span class="hs-identifier hs-var">Complete</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.html#Incomplete"><span class="hs-identifier hs-var">Incomplete</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-809"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span> </span><a href="#local-6989586621679057692"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679057690"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-number">1</span><span> </span><a href="#local-6989586621679057691"><span class="hs-identifier hs-var">gen</span></a><span class="hs-special">)</span><span>
</span><a name="line-810"></a><span>
</span><a name="line-811"></a><span>    </span><span class="hs-identifier">done</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679057676"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-type">RandomNState</span></a><span> </span><a href="#local-6989586621679057676"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057677"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057676"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679057677"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-812"></a><span>    </span><a name="local-6989586621679057640"><a href="#local-6989586621679057640"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Incomplete"><span class="hs-identifier hs-var">Incomplete</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-813"></a><span>    </span><span class="hs-identifier">done</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#RandomNState"><span class="hs-identifier hs-var">RandomNState</span></a><span>  </span><a href="Control.Foldl.html#Complete"><span class="hs-identifier hs-var">Complete</span></a><span>      </span><a name="local-6989586621679057693"><a href="#local-6989586621679057693"><span class="hs-identifier">mv</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-814"></a><span>        </span><a name="local-6989586621679057694"><a href="#local-6989586621679057694"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">freeze</span><span> </span><a href="#local-6989586621679057693"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-815"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679057694"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-816"></a><span>
</span><a name="line-817"></a><span class="hs-comment">-- | Converts an effectful function to a fold. Specialized version of 'sink'.</span><span>
</span><a name="line-818"></a><span class="hs-identifier">mapM_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679057111"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057112"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057111"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679057111"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679057112"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-819"></a><a name="mapM_"><a href="Control.Foldl.html#mapM_"><span class="hs-identifier">mapM_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#sink"><span class="hs-identifier hs-var">sink</span></a><span>
</span><a name="line-820"></a><span class="hs-pragma">{-# INLINABLE mapM_ #-}</span><span>
</span><a name="line-821"></a><span>
</span><a name="line-822"></a><span class="hs-comment">{-| Converts an effectful function to a fold

&gt; sink (f &lt;&gt; g) = sink f &lt;&gt; sink g -- if `(&lt;&gt;)` is commutative
&gt; sink mempty = mempty
-}</span><span>
</span><a name="line-827"></a><span>
</span><a name="line-828"></a><span>
</span><a name="line-829"></a><span class="hs-identifier">sink</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679057108"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679057109"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057110"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057109"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679057108"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679057109"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679057110"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057108"><span class="hs-identifier hs-type">w</span></a><span>
</span><a name="line-830"></a><a name="sink"><a href="Control.Foldl.html#sink"><span class="hs-identifier">sink</span></a></a><span> </span><a name="local-6989586621679057695"><a href="#local-6989586621679057695"><span class="hs-identifier">act</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057698"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057697"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057696"><span class="hs-identifier hs-var">done</span></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-831"></a><span>  </span><a name="local-6989586621679057696"><a href="#local-6989586621679057696"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-832"></a><span>  </span><a name="local-6989586621679057697"><a href="#local-6989586621679057697"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-833"></a><span>  </span><a name="local-6989586621679057698"><a href="#local-6989586621679057698"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057699"><a href="#local-6989586621679057699"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679057700"><a href="#local-6989586621679057700"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-834"></a><span>    </span><a name="local-6989586621679057701"><a href="#local-6989586621679057701"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679057695"><span class="hs-identifier hs-var">act</span></a><span> </span><a href="#local-6989586621679057700"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-835"></a><span>    </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$!</span><span> </span><span class="hs-identifier hs-var">mappend</span><span> </span><a href="#local-6989586621679057699"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="#local-6989586621679057701"><span class="hs-identifier hs-var">m'</span></a><span>
</span><a name="line-836"></a><span class="hs-pragma">{-# INLINABLE sink #-}</span><span>
</span><a name="line-837"></a><span>
</span><a name="line-838"></a><span class="hs-comment">-- | Like 'length', except with a more general 'Num' return value</span><span>
</span><a name="line-839"></a><span class="hs-identifier">genericLength</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679057106"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057107"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057106"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-840"></a><a name="genericLength"><a href="Control.Foldl.html#genericLength"><span class="hs-identifier">genericLength</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057702"><a href="#local-6989586621679057702"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057702"><span class="hs-identifier hs-var">n</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-841"></a><span class="hs-pragma">{-# INLINABLE genericLength #-}</span><span>
</span><a name="line-842"></a><span>
</span><a name="line-843"></a><span class="hs-comment">-- | Like 'index', except with a more general 'Integral' argument</span><span>
</span><a name="line-844"></a><span class="hs-identifier">genericIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679057104"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057104"><span class="hs-identifier hs-type">i</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057105"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679057105"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-845"></a><a name="genericIndex"><a href="Control.Foldl.html#genericIndex"><span class="hs-identifier">genericIndex</span></a></a><span> </span><a name="local-6989586621679057703"><a href="#local-6989586621679057703"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057704"><span class="hs-identifier hs-var">step</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057705"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-846"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-847"></a><span>    </span><a name="local-6989586621679057704"><a href="#local-6989586621679057704"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057706"><a href="#local-6989586621679057706"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057707"><a href="#local-6989586621679057707"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057706"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-848"></a><span>        </span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span>  </span><a name="local-6989586621679057708"><a href="#local-6989586621679057708"><span class="hs-identifier">j</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057703"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679057708"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.Internal.html#Right%27"><span class="hs-identifier hs-var">Right'</span></a><span> </span><a href="#local-6989586621679057707"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057708"><span class="hs-identifier hs-var">j</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-849"></a><span>        </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057706"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-850"></a><span>    </span><a name="local-6989586621679057705"><a href="#local-6989586621679057705"><span class="hs-identifier">done</span></a></a><span> </span><a name="local-6989586621679057709"><a href="#local-6989586621679057709"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057709"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-851"></a><span>        </span><a href="Control.Foldl.Internal.html#Left%27"><span class="hs-identifier hs-var">Left'</span></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-852"></a><span>        </span><a href="Control.Foldl.Internal.html#Right%27"><span class="hs-identifier hs-var">Right'</span></a><span> </span><a name="local-6989586621679057710"><a href="#local-6989586621679057710"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679057710"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-853"></a><span class="hs-pragma">{-# INLINABLE genericIndex #-}</span><span>
</span><a name="line-854"></a><span>
</span><a name="line-855"></a><span class="hs-comment">-- | Fold all values into a list</span><span>
</span><a name="line-856"></a><span class="hs-identifier">list</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057103"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057103"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-857"></a><a name="list"><a href="Control.Foldl.html#list"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057711"><a href="#local-6989586621679057711"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057712"><a href="#local-6989586621679057712"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057711"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057712"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">id</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-858"></a><span class="hs-pragma">{-# INLINABLE list #-}</span><span>
</span><a name="line-859"></a><span>
</span><a name="line-860"></a><span class="hs-comment">-- | Fold all values into a list, in reverse order</span><span>
</span><a name="line-861"></a><span class="hs-identifier">revList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057102"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057102"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-862"></a><a name="revList"><a href="Control.Foldl.html#revList"><span class="hs-identifier">revList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057713"><a href="#local-6989586621679057713"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057714"><a href="#local-6989586621679057714"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057714"><span class="hs-identifier hs-var">a</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679057713"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-863"></a><span class="hs-pragma">{-# INLINABLE revList #-}</span><span>
</span><a name="line-864"></a><span>
</span><a name="line-865"></a><span class="hs-comment">{-| /O(n log n)/.  Fold values into a list with duplicates removed, while
    preserving their first occurrences
-}</span><span>
</span><a name="line-868"></a><span class="hs-identifier">nub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679057101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057101"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057101"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-869"></a><a name="nub"><a href="Control.Foldl.html#nub"><span class="hs-identifier">nub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057715"><span class="hs-identifier hs-var">step</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057716"><span class="hs-identifier hs-var">fin</span></a><span>
</span><a name="line-870"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-871"></a><span>    </span><a name="local-6989586621679057715"><a href="#local-6989586621679057715"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679057717"><a href="#local-6989586621679057717"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679057718"><a href="#local-6989586621679057718"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057719"><a href="#local-6989586621679057719"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">member</span><span> </span><a href="#local-6989586621679057719"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679057717"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-872"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679057717"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679057718"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-873"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679057719"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679057717"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057718"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057719"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-874"></a><span>    </span><a name="local-6989586621679057716"><a href="#local-6989586621679057716"><span class="hs-identifier">fin</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679057720"><a href="#local-6989586621679057720"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057720"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-875"></a><span class="hs-pragma">{-# INLINABLE nub #-}</span><span>
</span><a name="line-876"></a><span>
</span><a name="line-877"></a><span class="hs-comment">{-| /O(n^2)/.  Fold values into a list with duplicates removed, while preserving
    their first occurrences
-}</span><span>
</span><a name="line-880"></a><span class="hs-identifier">eqNub</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057100"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057100"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-881"></a><a name="eqNub"><a href="Control.Foldl.html#eqNub"><span class="hs-identifier">eqNub</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057721"><span class="hs-identifier hs-var">step</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier hs-var">id</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057722"><span class="hs-identifier hs-var">fin</span></a><span>
</span><a name="line-882"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-883"></a><span>    </span><a name="local-6989586621679057721"><a href="#local-6989586621679057721"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679057723"><a href="#local-6989586621679057723"><span class="hs-identifier">known</span></a></a><span> </span><a name="local-6989586621679057724"><a href="#local-6989586621679057724"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057725"><a href="#local-6989586621679057725"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">List</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679057725"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679057723"><span class="hs-identifier hs-var">known</span></a><span>
</span><a name="line-884"></a><span>      </span><span class="hs-keyword">then</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679057723"><span class="hs-identifier hs-var">known</span></a><span> </span><a href="#local-6989586621679057724"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-885"></a><span>      </span><span class="hs-keyword">else</span><span> </span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057725"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679057723"><span class="hs-identifier hs-var">known</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057724"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057725"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-886"></a><span>    </span><a name="local-6989586621679057722"><a href="#local-6989586621679057722"><span class="hs-identifier">fin</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679057726"><a href="#local-6989586621679057726"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057726"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-887"></a><span class="hs-pragma">{-# INLINABLE eqNub #-}</span><span>
</span><a name="line-888"></a><span>
</span><a name="line-889"></a><span class="hs-comment">-- | Fold values into a set</span><span>
</span><a name="line-890"></a><span class="hs-identifier">set</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679057099"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057099"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Set</span><span> </span><a href="#local-6989586621679057099"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-891"></a><a name="set"><a href="Control.Foldl.html#set"><span class="hs-identifier">set</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-892"></a><span class="hs-pragma">{-# INLINABLE set #-}</span><span>
</span><a name="line-893"></a><span>
</span><a name="line-894"></a><span class="hs-comment">-- | Fold values into a hash-set</span><span>
</span><a name="line-895"></a><span class="hs-identifier">hashSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057098"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Hashable</span><span> </span><a href="#local-6989586621679057098"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679057098"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HashSet</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">HashSet</span><span> </span><a href="#local-6989586621679057098"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-896"></a><a name="hashSet"><a href="Control.Foldl.html#hashSet"><span class="hs-identifier">hashSet</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier hs-var">HashSet</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">HashSet</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-897"></a><span class="hs-pragma">{-# INLINABLE hashSet #-}</span><span>
</span><a name="line-898"></a><span>
</span><a name="line-899"></a><span class="hs-comment">{-|
Fold pairs into a map.
-}</span><span>
</span><a name="line-902"></a><span class="hs-identifier">map</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679057096"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057096"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057097"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679057096"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057097"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-903"></a><a name="map"><a href="Control.Foldl.html#map"><span class="hs-identifier">map</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057728"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057727"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057729"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-904"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-905"></a><span>    </span><a name="local-6989586621679057727"><a href="#local-6989586621679057727"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-906"></a><span>    </span><a name="local-6989586621679057728"><a href="#local-6989586621679057728"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057730"><a href="#local-6989586621679057730"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679057731"><a href="#local-6989586621679057731"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057732"><a href="#local-6989586621679057732"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679057731"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679057732"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679057730"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-907"></a><span>    </span><a name="local-6989586621679057729"><a href="#local-6989586621679057729"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-908"></a><span class="hs-pragma">{-# INLINABLE map #-}</span><span>
</span><a name="line-909"></a><span>
</span><a name="line-910"></a><span class="hs-comment">{-|
Fold pairs into a hash-map.
-}</span><span>
</span><a name="line-913"></a><span class="hs-identifier">hashMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679056221"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Hashable</span><span> </span><a href="#local-6989586621679056221"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056221"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679056222"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">HashMap</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">HashMap</span><span> </span><a href="#local-6989586621679056221"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056222"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-914"></a><a name="hashMap"><a href="Control.Foldl.html#hashMap"><span class="hs-identifier">hashMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057839"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057838"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057840"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-915"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-916"></a><span>    </span><a name="local-6989586621679057838"><a href="#local-6989586621679057838"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-917"></a><span>    </span><a name="local-6989586621679057839"><a href="#local-6989586621679057839"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057841"><a href="#local-6989586621679057841"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679057842"><a href="#local-6989586621679057842"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057843"><a href="#local-6989586621679057843"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">HashMap</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679057842"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679057843"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679057841"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-918"></a><span>    </span><a name="local-6989586621679057840"><a href="#local-6989586621679057840"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-919"></a><span class="hs-pragma">{-# INLINABLE hashMap #-}</span><span>
</span><a name="line-920"></a><span>
</span><a name="line-921"></a><span class="hs-comment">-- | Fold all values into a vector</span><span>
</span><a name="line-922"></a><span class="hs-identifier">vector</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679056219"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679056220"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056220"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056219"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679056220"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-923"></a><a name="vector"><a href="Control.Foldl.html#vector"><span class="hs-identifier">vector</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057845"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057844"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057846"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-924"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-925"></a><span>    </span><a name="local-6989586621679057844"><a href="#local-6989586621679057844"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VectorBuilder</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Builder</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-926"></a><span>
</span><a name="line-927"></a><span>    </span><a name="local-6989586621679057845"><a href="#local-6989586621679057845"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057901"><a href="#local-6989586621679057901"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057902"><a href="#local-6989586621679057902"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057901"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">VectorBuilder</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Builder</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><a href="#local-6989586621679057902"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-928"></a><span>
</span><a name="line-929"></a><span>    </span><a name="local-6989586621679057846"><a href="#local-6989586621679057846"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">VectorBuilder</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">Vector</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">build</span><span>
</span><a name="line-930"></a><span class="hs-pragma">{-# INLINABLE vector #-}</span><span>
</span><a name="line-931"></a><span>
</span><a name="line-932"></a><span class="hs-identifier">maxChunkSize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-933"></a><a name="maxChunkSize"><a href="Control.Foldl.html#maxChunkSize"><span class="hs-identifier">maxChunkSize</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">8</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">1024</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-number">1024</span><span>
</span><a name="line-934"></a><span>
</span><a name="line-935"></a><span class="hs-comment">{-| Fold all values into a vector

    This is more efficient than `vector` but is impure
-}</span><span>
</span><a name="line-939"></a><span class="hs-identifier">vectorM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">PrimMonad</span><span> </span><a href="#local-6989586621679056216"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Vector</span><span> </span><a href="#local-6989586621679056217"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679056218"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056216"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056218"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056217"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679056218"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-940"></a><a name="vectorM"><a href="Control.Foldl.html#vectorM"><span class="hs-identifier">vectorM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057904"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057903"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057905"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-941"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-942"></a><span>    </span><a name="local-6989586621679057903"><a href="#local-6989586621679057903"><span class="hs-identifier">begin</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-943"></a><span>        </span><a name="local-6989586621679057906"><a href="#local-6989586621679057906"><span class="hs-identifier">mv</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeNew</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-944"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679057906"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-945"></a><span>    </span><a name="local-6989586621679057904"><a href="#local-6989586621679057904"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679057907"><a href="#local-6989586621679057907"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679057908"><a href="#local-6989586621679057908"><span class="hs-identifier">idx</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057909"><a href="#local-6989586621679057909"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-946"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057910"><a href="#local-6989586621679057910"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679057907"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-947"></a><span>        </span><a name="local-6989586621679057911"><a href="#local-6989586621679057911"><span class="hs-identifier">mv'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057908"><span class="hs-identifier hs-var">idx</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679057910"><span class="hs-identifier hs-var">len</span></a><span>
</span><a name="line-948"></a><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeGrow</span><span> </span><a href="#local-6989586621679057907"><span class="hs-identifier hs-var">mv</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">min</span><span> </span><a href="#local-6989586621679057910"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="Control.Foldl.html#maxChunkSize"><span class="hs-identifier hs-var">maxChunkSize</span></a><span class="hs-special">)</span><span>
</span><a name="line-949"></a><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679057907"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-950"></a><span>        </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeWrite</span><span> </span><a href="#local-6989586621679057911"><span class="hs-identifier hs-var">mv'</span></a><span> </span><a href="#local-6989586621679057908"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621679057909"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-951"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a href="#local-6989586621679057911"><span class="hs-identifier hs-var">mv'</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057908"><span class="hs-identifier hs-var">idx</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-952"></a><span>    </span><a name="local-6989586621679057905"><a href="#local-6989586621679057905"><span class="hs-identifier">done</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Pair"><span class="hs-identifier hs-var">Pair</span></a><span> </span><a name="local-6989586621679057912"><a href="#local-6989586621679057912"><span class="hs-identifier">mv</span></a></a><span> </span><a name="local-6989586621679057913"><a href="#local-6989586621679057913"><span class="hs-identifier">idx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-953"></a><span>        </span><a name="local-6989586621679057914"><a href="#local-6989586621679057914"><span class="hs-identifier">v</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">freeze</span><span> </span><a href="#local-6989586621679057912"><span class="hs-identifier hs-var">mv</span></a><span>
</span><a name="line-954"></a><span>        </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">V</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unsafeTake</span><span> </span><a href="#local-6989586621679057913"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="#local-6989586621679057914"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-955"></a><span class="hs-pragma">{-# INLINABLE vectorM #-}</span><span>
</span><a name="line-956"></a><span>
</span><a name="line-957"></a><span class="hs-comment">{- $utilities
    'purely' and 'impurely' allow you to write folds compatible with the @foldl@
    library without incurring a @foldl@ dependency.  Write your fold to accept
    three parameters corresponding to the step function, initial
    accumulator, and extraction function and then users can upgrade your
    function to accept a 'Fold' or 'FoldM' using the 'purely' or 'impurely'
    combinators.

    For example, the @pipes@ library implements @fold@ and @foldM@ functions in
    @Pipes.Prelude@ with the following type:

&gt; Pipes.Prelude.fold
&gt;     :: Monad m
&gt;     -&gt; (x -&gt; a -&gt; x) -&gt; x -&gt; (x -&gt; b) -&gt; Producer a m () -&gt; m b
&gt;
&gt; Pipes.Prelude.foldM
&gt;     :: Monad m
&gt;     =&gt; (x -&gt; a -&gt; m x) -&gt; m x -&gt; (x -&gt; m b) -&gt; Producer a m () -&gt; m b

    Both @fold@ and @foldM@ is set up so that you can wrap them with either
    'purely' or 'impurely' to accept a 'Fold' or 'FoldM', respectively:

&gt; purely Pipes.Prelude.fold
&gt;     :: Monad m =&gt; Fold a b -&gt; Producer a m () -&gt; m b
&gt;
&gt; impurely Pipes.Prelude.foldM
&gt;     :: Monad m =&gt; FoldM m a b -&gt; Producer a m () -&gt; m b

    Other streaming libraries supporting 'purely' and 'impurely' include @io-streams@ and @streaming@. 
    So for example we have:

&gt; purely System.IO.Streams.fold_ 
&gt;     :: Fold a b -&gt; Streams.InputStream a -&gt; IO b
&gt;
&gt; impurely System.IO.Streams.foldM_ 
&gt;     :: FoldM IO a b -&gt; Streams.InputStream a -&gt; IO b

    The @monotraversable@ package makes it convenient to apply a 
    'Fold' or 'FoldM' to pure containers that do not allow 
    a general 'Foldable' instance, like unboxed vectors:

&gt; purely ofoldlUnwrap
&gt;     :: MonoFoldable mono
&gt;     =&gt; Fold (Element mono) b -&gt; mono -&gt; b
&gt;
&gt; impurely ofoldMUnwrap
&gt;     :: MonoFoldable mono
&gt;     =&gt; FoldM m (Element mono) b -&gt; mono -&gt; m b
-}</span><span>
</span><a name="line-1006"></a><span>
</span><a name="line-1007"></a><span class="hs-comment">-- | Upgrade a fold to accept the 'Fold' type</span><span>
</span><a name="line-1008"></a><span class="hs-identifier">purely</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679056215"><a href="#local-6989586621679056215"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056215"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056212"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056215"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056215"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056215"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056213"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056214"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056212"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056213"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056214"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1009"></a><a name="purely"><a href="Control.Foldl.html#purely"><span class="hs-identifier">purely</span></a></a><span> </span><a name="local-6989586621679057915"><a href="#local-6989586621679057915"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057916"><a href="#local-6989586621679057916"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057917"><a href="#local-6989586621679057917"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057918"><a href="#local-6989586621679057918"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057915"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057916"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057917"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057918"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1010"></a><span class="hs-pragma">{-# INLINABLE purely #-}</span><span>
</span><a name="line-1011"></a><span>
</span><a name="line-1012"></a><span class="hs-comment">-- | Upgrade a more traditional fold to accept the `Fold` type</span><span>
</span><a name="line-1013"></a><span class="hs-identifier">purely_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679056211"><a href="#local-6989586621679056211"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056211"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056209"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056211"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056211"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056211"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056209"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056210"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056210"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1014"></a><a name="purely_"><a href="Control.Foldl.html#purely_"><span class="hs-identifier">purely_</span></a></a><span> </span><a name="local-6989586621679057919"><a href="#local-6989586621679057919"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057920"><a href="#local-6989586621679057920"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057921"><a href="#local-6989586621679057921"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057922"><a href="#local-6989586621679057922"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057922"><span class="hs-identifier hs-var">done</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057919"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057920"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057921"><span class="hs-identifier hs-var">begin</span></a><span class="hs-special">)</span><span>
</span><a name="line-1015"></a><span class="hs-pragma">{-# INLINABLE purely_ #-}</span><span>
</span><a name="line-1016"></a><span>
</span><a name="line-1017"></a><span class="hs-comment">-- | Upgrade a monadic fold to accept the 'FoldM' type</span><span>
</span><a name="line-1018"></a><span class="hs-identifier">impurely</span><span>
</span><a name="line-1019"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679056208"><a href="#local-6989586621679056208"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056208"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056204"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056205"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056208"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056205"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056208"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056208"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056205"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056206"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056207"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1020"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056205"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056204"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056206"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1021"></a><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056207"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1022"></a><a name="impurely"><a href="Control.Foldl.html#impurely"><span class="hs-identifier">impurely</span></a></a><span> </span><a name="local-6989586621679057923"><a href="#local-6989586621679057923"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057924"><a href="#local-6989586621679057924"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057925"><a href="#local-6989586621679057925"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057926"><a href="#local-6989586621679057926"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057923"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057924"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057925"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057926"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1023"></a><span class="hs-pragma">{-# INLINABLE impurely #-}</span><span>
</span><a name="line-1024"></a><span>
</span><a name="line-1025"></a><span class="hs-comment">-- | Upgrade a more traditional monadic fold to accept the `FoldM` type</span><span>
</span><a name="line-1026"></a><span class="hs-identifier">impurely_</span><span>
</span><a name="line-1027"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679056200"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-1028"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679056203"><a href="#local-6989586621679056203"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056203"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056201"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056200"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056203"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056200"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056203"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056200"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056203"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056200"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056201"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056202"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056200"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056202"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1029"></a><a name="impurely_"><a href="Control.Foldl.html#impurely_"><span class="hs-identifier">impurely_</span></a></a><span> </span><a name="local-6989586621679057927"><a href="#local-6989586621679057927"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057928"><a href="#local-6989586621679057928"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057929"><a href="#local-6989586621679057929"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057930"><a href="#local-6989586621679057930"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1030"></a><span>    </span><a name="local-6989586621679057931"><a href="#local-6989586621679057931"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679057927"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057928"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057929"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-1031"></a><span>    </span><a href="#local-6989586621679057930"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057931"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1032"></a><span class="hs-pragma">{-# INLINABLE impurely_ #-}</span><span>
</span><a name="line-1033"></a><span>
</span><a name="line-1034"></a><span class="hs-comment">{-| Generalize a `Fold` to a `FoldM`

&gt; generalize (pure r) = pure r
&gt;
&gt; generalize (f &lt;*&gt; x) = generalize f &lt;*&gt; generalize x
-}</span><span>
</span><a name="line-1040"></a><span class="hs-identifier">generalize</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679056197"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056198"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056199"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056197"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056198"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056199"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1041"></a><a name="generalize"><a href="Control.Foldl.html#generalize"><span class="hs-identifier">generalize</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057932"><a href="#local-6989586621679057932"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057933"><a href="#local-6989586621679057933"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057934"><a href="#local-6989586621679057934"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057935"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057936"><span class="hs-identifier hs-var">begin'</span></a><span> </span><a href="#local-6989586621679057937"><span class="hs-identifier hs-var">done'</span></a><span>
</span><a name="line-1042"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1043"></a><span>    </span><a name="local-6989586621679057935"><a href="#local-6989586621679057935"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057938"><a href="#local-6989586621679057938"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057939"><a href="#local-6989586621679057939"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057932"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057938"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057939"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1044"></a><span>    </span><a name="local-6989586621679057936"><a href="#local-6989586621679057936"><span class="hs-identifier">begin'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span>  </span><a href="#local-6989586621679057933"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-1045"></a><span>    </span><a name="local-6989586621679057937"><a href="#local-6989586621679057937"><span class="hs-identifier">done'</span></a></a><span> </span><a name="local-6989586621679057940"><a href="#local-6989586621679057940"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057934"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057940"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1046"></a><span class="hs-pragma">{-# INLINABLE generalize #-}</span><span>
</span><a name="line-1047"></a><span>
</span><a name="line-1048"></a><span class="hs-comment">{-| Simplify a pure `FoldM` to a `Fold`

&gt; simplify (pure r) = pure r
&gt;
&gt; simplify (f &lt;*&gt; x) = simplify f &lt;*&gt; simplify x
-}</span><span>
</span><a name="line-1054"></a><span class="hs-identifier">simplify</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span> </span><a href="#local-6989586621679056195"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056196"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056195"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056196"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1055"></a><a name="simplify"><a href="Control.Foldl.html#simplify"><span class="hs-identifier">simplify</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057941"><a href="#local-6989586621679057941"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057942"><a href="#local-6989586621679057942"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057943"><a href="#local-6989586621679057943"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057944"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057945"><span class="hs-identifier hs-var">begin'</span></a><span> </span><a href="#local-6989586621679057946"><span class="hs-identifier hs-var">done'</span></a><span>
</span><a name="line-1056"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1057"></a><span>    </span><a name="local-6989586621679057944"><a href="#local-6989586621679057944"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057947"><a href="#local-6989586621679057947"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057948"><a href="#local-6989586621679057948"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057941"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057947"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057948"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1058"></a><span>    </span><a name="local-6989586621679057945"><a href="#local-6989586621679057945"><span class="hs-identifier">begin'</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span>  </span><a href="#local-6989586621679057942"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-1059"></a><span>    </span><a name="local-6989586621679057946"><a href="#local-6989586621679057946"><span class="hs-identifier">done'</span></a></a><span> </span><a name="local-6989586621679057949"><a href="#local-6989586621679057949"><span class="hs-identifier">x</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057943"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679057949"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-1060"></a><span class="hs-pragma">{-# INLINABLE simplify #-}</span><span>
</span><a name="line-1061"></a><span>
</span><a name="line-1062"></a><span>
</span><a name="line-1063"></a><span class="hs-comment">{- | Shift a 'FoldM' from one monad to another with a morphism such as 'lift' or 'liftIO';
     the effect is the same as 'Control.Monad.Morph.hoist'.
-}</span><span>
</span><a name="line-1066"></a><span class="hs-identifier">hoists</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679056194"><a href="#local-6989586621679056194"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="#local-6989586621679056190"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056194"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056191"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679056194"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056190"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056192"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056193"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056191"><span class="hs-identifier hs-type">n</span></a><span> </span><a href="#local-6989586621679056192"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056193"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1067"></a><a name="hoists"><a href="Control.Foldl.html#hoists"><span class="hs-identifier">hoists</span></a></a><span> </span><a name="local-6989586621679057950"><a href="#local-6989586621679057950"><span class="hs-identifier">phi</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057951"><a href="#local-6989586621679057951"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057952"><a href="#local-6989586621679057952"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057953"><a href="#local-6989586621679057953"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057954"><a href="#local-6989586621679057954"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679057955"><a href="#local-6989586621679057955"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057950"><span class="hs-identifier hs-var">phi</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057951"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057954"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679057955"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057950"><span class="hs-identifier hs-var">phi</span></a><span> </span><a href="#local-6989586621679057952"><span class="hs-identifier hs-var">begin</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057950"><span class="hs-identifier hs-var">phi</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679057953"><span class="hs-identifier hs-var">done</span></a><span class="hs-special">)</span><span>
</span><a name="line-1068"></a><span class="hs-pragma">{-# INLINABLE hoists #-}</span><span>
</span><a name="line-1069"></a><span>
</span><a name="line-1070"></a><span class="hs-comment">{-| Allows to continue feeding a 'FoldM' even after passing it to a function
that closes it.

For pure 'Fold's, this is provided by the 'Control.Comonad.Comonad' instance.
-}</span><span>
</span><a name="line-1075"></a><span class="hs-identifier">duplicateM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679056187"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056187"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056188"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056189"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056187"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056188"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056187"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056188"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056189"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-1076"></a><a name="duplicateM"><a href="Control.Foldl.html#duplicateM"><span class="hs-identifier">duplicateM</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057956"><a href="#local-6989586621679057956"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057957"><a href="#local-6989586621679057957"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057958"><a href="#local-6989586621679057958"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1077"></a><span>    </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057956"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057957"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057959"><a href="#local-6989586621679057959"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057956"><span class="hs-identifier hs-var">step</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679057959"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057958"><span class="hs-identifier hs-var">done</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1078"></a><span class="hs-pragma">{-# INLINABLE duplicateM #-}</span><span>
</span><a name="line-1079"></a><span>
</span><a name="line-1080"></a><span class="hs-comment">{-| @_Fold1 step@ returns a new 'Fold' using just a step function that has the
same type for the accumulator and the element. The result type is the
accumulator type wrapped in 'Maybe'. The initial accumulator is retrieved from
the 'Foldable', the result is 'None' for empty containers.
 -}</span><span>
</span><a name="line-1085"></a><span class="hs-identifier">_Fold1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056186"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056186"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056186"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056186"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679056186"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1086"></a><a name="_Fold1"><a href="Control.Foldl.html#_Fold1"><span class="hs-identifier">_Fold1</span></a></a><span> </span><a name="local-6989586621679057960"><a href="#local-6989586621679057960"><span class="hs-identifier">step</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057961"><span class="hs-identifier hs-var">step_</span></a><span> </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><a href="Control.Foldl.Internal.html#lazy"><span class="hs-identifier hs-var">lazy</span></a><span>
</span><a name="line-1087"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1088"></a><span>    </span><a name="local-6989586621679057961"><a href="#local-6989586621679057961"><span class="hs-identifier">step_</span></a></a><span> </span><a name="local-6989586621679057962"><a href="#local-6989586621679057962"><span class="hs-identifier">mx</span></a></a><span> </span><a name="local-6989586621679057963"><a href="#local-6989586621679057963"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057962"><span class="hs-identifier hs-var">mx</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-1089"></a><span>        </span><a href="Control.Foldl.Internal.html#Nothing%27"><span class="hs-identifier hs-var">Nothing'</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057963"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1090"></a><span>        </span><a href="Control.Foldl.Internal.html#Just%27"><span class="hs-identifier hs-var">Just'</span></a><span> </span><a name="local-6989586621679057964"><a href="#local-6989586621679057964"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057960"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057964"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057963"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1091"></a><span class="hs-pragma">{-# INLINABLE _Fold1 #-}</span><span>
</span><a name="line-1092"></a><span>
</span><a name="line-1093"></a><span class="hs-comment">{-| @(premap f folder)@ returns a new 'Fold' where f is applied at each step

&gt; fold (premap f folder) list = fold folder (map f list)

&gt;&gt;&gt; fold (premap Sum mconcat) [1..10]
Sum {getSum = 55}

&gt;&gt;&gt; fold mconcat (map Sum [1..10])
Sum {getSum = 55}

&gt; premap id = id
&gt;
&gt; premap (f . g) = premap g . premap f

&gt; premap k (pure r) = pure r
&gt;
&gt; premap k (f &lt;*&gt; x) = premap k f &lt;*&gt; premap k x
-}</span><span>
</span><a name="line-1111"></a><span class="hs-identifier">premap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056183"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056184"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056184"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679056185"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056183"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056185"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1112"></a><a name="premap"><a href="Control.Foldl.html#premap"><span class="hs-identifier">premap</span></a></a><span> </span><a name="local-6989586621679057965"><a href="#local-6989586621679057965"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057966"><a href="#local-6989586621679057966"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057967"><a href="#local-6989586621679057967"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057968"><a href="#local-6989586621679057968"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057969"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057967"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057968"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1113"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1114"></a><span>    </span><a name="local-6989586621679057969"><a href="#local-6989586621679057969"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057970"><a href="#local-6989586621679057970"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057971"><a href="#local-6989586621679057971"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057966"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057970"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057965"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057971"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1115"></a><span class="hs-pragma">{-# INLINABLE premap #-}</span><span>
</span><a name="line-1116"></a><span>
</span><a name="line-1117"></a><span class="hs-comment">{-| @(premapM f folder)@ returns a new 'FoldM' where f is applied to each input
    element

&gt; foldM (premapM f folder) list = foldM folder (map f list)

&gt; premapM id = id
&gt;
&gt; premapM (f . g) = premap g . premap f

&gt; premapM k (pure r) = pure r
&gt;
&gt; premapM k (f &lt;*&gt; x) = premapM k f &lt;*&gt; premapM k x
-}</span><span>
</span><a name="line-1130"></a><span class="hs-identifier">premapM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056179"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056180"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056181"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056180"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679056182"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056181"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056179"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056182"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1131"></a><a name="premapM"><a href="Control.Foldl.html#premapM"><span class="hs-identifier">premapM</span></a></a><span> </span><a name="local-6989586621679057972"><a href="#local-6989586621679057972"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057973"><a href="#local-6989586621679057973"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057974"><a href="#local-6989586621679057974"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057975"><a href="#local-6989586621679057975"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057976"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057974"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057975"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1132"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1133"></a><span>    </span><a name="local-6989586621679057976"><a href="#local-6989586621679057976"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057977"><a href="#local-6989586621679057977"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057978"><a href="#local-6989586621679057978"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057973"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057977"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057972"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057978"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-1134"></a><span class="hs-pragma">{-# INLINABLE premapM #-}</span><span>
</span><a name="line-1135"></a><span>
</span><a name="line-1136"></a><span class="hs-comment">{-| @(prefilter f folder)@ returns a new 'Fold' where the folder's input is used
  only when the input satisfies a predicate f

  This can also be done with 'handles' (@handles (filtered f)@) but @prefilter@
  does not need you to depend on a lens library.

&gt; fold (prefilter p folder) list = fold folder (filter p list)

&gt;&gt;&gt; fold (prefilter (&gt;5) Control.Foldl.sum) [1..10]
40

&gt;&gt;&gt; fold Control.Foldl.sum (filter (&gt;5) [1..10])
40
-}</span><span>
</span><a name="line-1150"></a><span class="hs-identifier">prefilter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056177"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056177"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056178"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056177"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056178"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1151"></a><a name="prefilter"><a href="Control.Foldl.html#prefilter"><span class="hs-identifier">prefilter</span></a></a><span> </span><a name="local-6989586621679057979"><a href="#local-6989586621679057979"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057980"><a href="#local-6989586621679057980"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057981"><a href="#local-6989586621679057981"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057982"><a href="#local-6989586621679057982"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057983"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057981"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057982"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1152"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1153"></a><span>    </span><a name="local-6989586621679057983"><a href="#local-6989586621679057983"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057984"><a href="#local-6989586621679057984"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057985"><a href="#local-6989586621679057985"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057979"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057985"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679057980"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057984"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057985"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679057984"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1154"></a><span class="hs-pragma">{-# INLINABLE prefilter #-}</span><span>
</span><a name="line-1155"></a><span>
</span><a name="line-1156"></a><span class="hs-comment">{-| @(prefilterM f folder)@ returns a new 'Fold' where the folder's input is used
  only when the input satisfies a monadic predicate f.

&gt; foldM (prefilterM p folder) list = foldM folder (filter p list)
-}</span><span>
</span><a name="line-1161"></a><span class="hs-identifier">prefilterM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679056174"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056175"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056174"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056174"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056175"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056176"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056174"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056175"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056176"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1162"></a><a name="prefilterM"><a href="Control.Foldl.html#prefilterM"><span class="hs-identifier">prefilterM</span></a></a><span> </span><a name="local-6989586621679057986"><a href="#local-6989586621679057986"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679057987"><a href="#local-6989586621679057987"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057988"><a href="#local-6989586621679057988"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057989"><a href="#local-6989586621679057989"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679057990"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057988"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057989"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1163"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1164"></a><span>    </span><a name="local-6989586621679057990"><a href="#local-6989586621679057990"><span class="hs-identifier">step'</span></a></a><span> </span><a name="local-6989586621679057991"><a href="#local-6989586621679057991"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679057992"><a href="#local-6989586621679057992"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1165"></a><span>      </span><a name="local-6989586621679057993"><a href="#local-6989586621679057993"><span class="hs-identifier">use</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679057986"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679057992"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-1166"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057993"><span class="hs-identifier hs-var">use</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679057987"><span class="hs-identifier hs-var">step</span></a><span> </span><a href="#local-6989586621679057991"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679057992"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679057991"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1167"></a><span class="hs-pragma">{-# INLINABLE prefilterM #-}</span><span>
</span><a name="line-1168"></a><span>
</span><a name="line-1169"></a><span class="hs-comment">{-| A handler for the upstream input of a `Fold`

    Any lens, traversal, or prism will type-check as a `Handler`
-}</span><span>
</span><a name="line-1173"></a><span class="hs-keyword">type</span><span> </span><a name="Handler"><a href="Control.Foldl.html#Handler"><span class="hs-identifier">Handler</span></a></a><span> </span><a name="local-6989586621679052046"><a href="#local-6989586621679052046"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679052047"><a href="#local-6989586621679052047"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1174"></a><span>    </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679052048"><a href="#local-6989586621679052048"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052047"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Dual</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Endo</span><span> </span><a href="#local-6989586621679052048"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679052047"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052046"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Dual</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Endo</span><span> </span><a href="#local-6989586621679052048"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679052046"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1175"></a><span>
</span><a name="line-1176"></a><span class="hs-comment">{-| @(handles t folder)@ transforms the input of a `Fold` using a lens,
    traversal, or prism:

&gt; handles _1       :: Fold a r -&gt; Fold (a, b) r
&gt; handles _Left    :: Fold a r -&gt; Fold (Either a b) r
&gt; handles traverse :: Traversable t =&gt; Fold a r -&gt; Fold (t a) r
&gt; handles folded   :: Foldable    t =&gt; Fold a r -&gt; Fold (t a) r

&gt;&gt;&gt; fold (handles traverse sum) [[1..5],[6..10]]
55

&gt;&gt;&gt; fold (handles (traverse.traverse) sum) [[Nothing, Just 2, Just 7],[Just 13, Nothing, Just 20]]
42

&gt;&gt;&gt; fold (handles (filtered even) sum) [1..10]
30

&gt;&gt;&gt; fold (handles _2 mconcat) [(1,&quot;Hello &quot;),(2,&quot;World&quot;),(3,&quot;!&quot;)]
&quot;Hello World!&quot;

&gt; handles id = id
&gt;
&gt; handles (f . g) = handles f . handles g

&gt; handles t (pure r) = pure r
&gt;
&gt; handles t (f &lt;*&gt; x) = handles t f &lt;*&gt; handles t x
-}</span><span>
</span><a name="line-1204"></a><span class="hs-identifier">handles</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><a href="#local-6989586621679056171"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056172"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056172"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679056173"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056171"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056173"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1205"></a><a name="handles"><a href="Control.Foldl.html#handles"><span class="hs-identifier">handles</span></a></a><span> </span><a name="local-6989586621679057994"><a href="#local-6989586621679057994"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679057995"><a href="#local-6989586621679057995"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679057996"><a href="#local-6989586621679057996"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679057997"><a href="#local-6989586621679057997"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679057998"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679057996"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679057997"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1206"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1207"></a><span>    </span><a name="local-6989586621679057998"><a href="#local-6989586621679057998"><span class="hs-identifier">step'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">appEndo</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getDual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getConst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679057994"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Const</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Dual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Endo</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="#local-6989586621679057995"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1208"></a><span class="hs-pragma">{-# INLINABLE handles #-}</span><span>
</span><a name="line-1209"></a><span>
</span><a name="line-1210"></a><span class="hs-comment">{- | @(foldOver f folder xs)@ folds all values from a Lens, Traversal, Prism or Fold with the given folder

&gt;&gt;&gt; foldOver (_Just . both) L.sum (Just (2, 3))
5

&gt;&gt;&gt; foldOver (_Just . both) L.sum Nothing
0

&gt; L.foldOver f folder xs == L.fold folder (xs^..f)

&gt; L.foldOver (folded.f) folder == L.fold (handles f folder)

&gt; L.foldOver folded == L.fold

-}</span><span>
</span><a name="line-1225"></a><span class="hs-identifier">foldOver</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#Handler"><span class="hs-identifier hs-type">Handler</span></a><span> </span><a href="#local-6989586621679056168"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056169"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679056169"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056170"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056168"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056170"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1226"></a><a name="foldOver"><a href="Control.Foldl.html#foldOver"><span class="hs-identifier">foldOver</span></a></a><span> </span><a name="local-6989586621679057999"><a href="#local-6989586621679057999"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679058000"><a href="#local-6989586621679058000"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679058001"><a href="#local-6989586621679058001"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679058002"><a href="#local-6989586621679058002"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1227"></a><span>  </span><a href="#local-6989586621679058002"><span class="hs-identifier hs-var">done</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier">appEndo</span><span> </span><a href="#local-6989586621679058001"><span class="hs-identifier hs-var">begin</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getDual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getConst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679057999"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Const</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Dual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Endo</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="#local-6989586621679058000"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span>
</span><a name="line-1228"></a><span class="hs-pragma">{-# INLINABLE foldOver #-}</span><span>
</span><a name="line-1229"></a><span>
</span><a name="line-1230"></a><span class="hs-comment">{-|
&gt; instance Monad m =&gt; Monoid (EndoM m a) where
&gt;     mempty = EndoM return
&gt;     mappend (EndoM f) (EndoM g) = EndoM (f &lt;=&lt; g)
-}</span><span>
</span><a name="line-1235"></a><span class="hs-keyword">newtype</span><span> </span><a name="EndoM"><a href="Control.Foldl.html#EndoM"><span class="hs-identifier">EndoM</span></a></a><span> </span><a name="local-6989586621679052044"><a href="#local-6989586621679052044"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679052045"><a href="#local-6989586621679052045"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EndoM"><a href="Control.Foldl.html#EndoM"><span class="hs-identifier">EndoM</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="appEndoM"><a href="Control.Foldl.html#appEndoM"><span class="hs-identifier">appEndoM</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679052045"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052044"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052045"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-1236"></a><span>
</span><a name="line-1237"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052065"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Semigroup</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-type">EndoM</span></a><span> </span><a href="#local-6989586621679052065"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052066"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1238"></a><span>    </span><span class="hs-special">(</span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-var">EndoM</span></a><span> </span><a name="local-6989586621679052067"><a href="#local-6989586621679052067"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><a name="local-3458764513820541482"><span class="hs-operator">&lt;&gt;</span></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-var">EndoM</span></a><span> </span><a name="local-6989586621679052068"><a href="#local-6989586621679052068"><span class="hs-identifier">g</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-var">EndoM</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052067"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-operator hs-var">&lt;=&lt;</span><span> </span><a href="#local-6989586621679052068"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-1239"></a><span>    </span><span class="hs-pragma">{-# INLINE (&lt;&gt;) #-}</span><span>
</span><a name="line-1240"></a><span>
</span><a name="line-1241"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679052063"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-type">EndoM</span></a><span> </span><a href="#local-6989586621679052063"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679052064"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-1242"></a><span>    </span><a name="local-3458764513820541483"><span class="hs-identifier">mempty</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-var">EndoM</span></a><span> </span><span class="hs-identifier hs-var">return</span><span>
</span><a name="line-1243"></a><span>    </span><span class="hs-pragma">{-# INLINE mempty #-}</span><span>
</span><a name="line-1244"></a><span>
</span><a name="line-1245"></a><span>    </span><a name="local-3458764513820541484"><span class="hs-identifier">mappend</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-1246"></a><span>    </span><span class="hs-pragma">{-# INLINE mappend #-}</span><span>
</span><a name="line-1247"></a><span>
</span><a name="line-1248"></a><span class="hs-comment">{-| A Handler for the upstream input of `FoldM`

    Any lens, traversal, or prism will type-check as a `HandlerM`
-}</span><span>
</span><a name="line-1252"></a><span class="hs-keyword">type</span><span> </span><a name="HandlerM"><a href="Control.Foldl.html#HandlerM"><span class="hs-identifier">HandlerM</span></a></a><span> </span><a name="local-6989586621679051847"><a href="#local-6989586621679051847"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679051848"><a href="#local-6989586621679051848"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679051849"><a href="#local-6989586621679051849"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-1253"></a><span>    </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679051850"><a href="#local-6989586621679051850"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679051849"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Dual</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-type">EndoM</span></a><span> </span><a href="#local-6989586621679051847"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679051850"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679051849"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679051848"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Const</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Dual</span><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-type">EndoM</span></a><span> </span><a href="#local-6989586621679051847"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679051850"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679051848"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-1254"></a><span>
</span><a name="line-1255"></a><span class="hs-comment">{-| @(handlesM t folder)@ transforms the input of a `FoldM` using a lens,
    traversal, or prism:

&gt; handlesM _1       :: FoldM m a r -&gt; FoldM (a, b) r
&gt; handlesM _Left    :: FoldM m a r -&gt; FoldM (Either a b) r
&gt; handlesM traverse :: Traversable t =&gt; FoldM m a r -&gt; FoldM m (t a) r
&gt; handlesM folded   :: Foldable    t =&gt; FoldM m a r -&gt; FoldM m (t a) r

    `handlesM` obeys these laws:

&gt; handlesM id = id
&gt;
&gt; handlesM (f . g) = handlesM f . handlesM g

&gt; handlesM t (pure r) = pure r
&gt;
&gt; handlesM t (f &lt;*&gt; x) = handlesM t f &lt;*&gt; handlesM t x
-}</span><span>
</span><a name="line-1273"></a><span class="hs-identifier">handlesM</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Control.Foldl.html#HandlerM"><span class="hs-identifier hs-type">HandlerM</span></a><span> </span><a href="#local-6989586621679056164"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056165"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056166"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056164"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056166"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679056167"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056164"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056165"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056167"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-1274"></a><a name="handlesM"><a href="Control.Foldl.html#handlesM"><span class="hs-identifier">handlesM</span></a></a><span> </span><a name="local-6989586621679058003"><a href="#local-6989586621679058003"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679058004"><a href="#local-6989586621679058004"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679058005"><a href="#local-6989586621679058005"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679058006"><a href="#local-6989586621679058006"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a href="#local-6989586621679058007"><span class="hs-identifier hs-var">step'</span></a><span> </span><a href="#local-6989586621679058005"><span class="hs-identifier hs-var">begin</span></a><span> </span><a href="#local-6989586621679058006"><span class="hs-identifier hs-var">done</span></a><span>
</span><a name="line-1275"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1276"></a><span>    </span><a name="local-6989586621679058007"><a href="#local-6989586621679058007"><span class="hs-identifier">step'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">appEndoM</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getDual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getConst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679058003"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Const</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Dual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-var">EndoM</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="#local-6989586621679058004"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1277"></a><span class="hs-pragma">{-# INLINABLE handlesM #-}</span><span>
</span><a name="line-1278"></a><span>
</span><a name="line-1279"></a><span class="hs-comment">{- | @(foldOverM f folder xs)@ folds all values from a Lens, Traversal, Prism or Fold monadically with the given folder

&gt; L.foldOverM (folded.f) folder == L.foldM (handlesM f folder)

&gt; L.foldOverM folded == L.foldM

-}</span><span>
</span><a name="line-1286"></a><span class="hs-identifier">foldOverM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679056160"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Foldl.html#HandlerM"><span class="hs-identifier hs-type">HandlerM</span></a><span> </span><a href="#local-6989586621679056160"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056161"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679056162"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-type">FoldM</span></a><span> </span><a href="#local-6989586621679056160"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056162"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679056163"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056161"><span class="hs-identifier hs-type">s</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056160"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679056163"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-1287"></a><a name="foldOverM"><a href="Control.Foldl.html#foldOverM"><span class="hs-identifier">foldOverM</span></a></a><span> </span><a name="local-6989586621679058008"><a href="#local-6989586621679058008"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#FoldM"><span class="hs-identifier hs-var">FoldM</span></a><span> </span><a name="local-6989586621679058009"><a href="#local-6989586621679058009"><span class="hs-identifier">step</span></a></a><span> </span><a name="local-6989586621679058010"><a href="#local-6989586621679058010"><span class="hs-identifier">begin</span></a></a><span> </span><a name="local-6989586621679058011"><a href="#local-6989586621679058011"><span class="hs-identifier">done</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679058012"><a href="#local-6989586621679058012"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-1288"></a><span>  </span><a name="local-6989586621679058013"><a href="#local-6989586621679058013"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679058010"><span class="hs-identifier hs-var">begin</span></a><span>
</span><a name="line-1289"></a><span>  </span><a name="local-6989586621679058014"><a href="#local-6989586621679058014"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-identifier">appEndoM</span><span> </span><a href="#local-6989586621679058013"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getDual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">getConst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679058008"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Const</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Dual</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Foldl.html#EndoM"><span class="hs-identifier hs-var">EndoM</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="#local-6989586621679058009"><span class="hs-identifier hs-var">step</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058012"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-1290"></a><span>  </span><a href="#local-6989586621679058011"><span class="hs-identifier hs-var">done</span></a><span> </span><a href="#local-6989586621679058014"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-1291"></a><span class="hs-pragma">{-# INLINABLE foldOverM #-}</span><span>
</span><a name="line-1292"></a><span>
</span><a name="line-1293"></a><span class="hs-comment">{-|
&gt; folded :: Foldable t =&gt; Fold (t a) a
&gt;
&gt; handles folded :: Foldable t =&gt; Fold a r -&gt; Fold (t a) r
-}</span><span>
</span><a name="line-1298"></a><span class="hs-identifier">folded</span><span>
</span><a name="line-1299"></a><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Contravariant</span><span> </span><a href="#local-6989586621679056157"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679056157"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679056158"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-1300"></a><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056157"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679056159"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056158"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679056159"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056157"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056158"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679056159"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-1301"></a><a name="folded"><a href="Control.Foldl.html#folded"><span class="hs-identifier">folded</span></a></a><span> </span><a name="local-6989586621679058015"><a href="#local-6989586621679058015"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679058016"><a href="#local-6989586621679058016"><span class="hs-identifier">ts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">contramap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">traverse_</span><span> </span><a href="#local-6989586621679058015"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679058016"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">)</span><span>
</span><a name="line-1302"></a><span class="hs-pragma">{-# INLINABLE folded #-}</span><span>
</span><a name="line-1303"></a><span>
</span><a name="line-1304"></a><span class="hs-comment">{-|
&gt;&gt;&gt; fold (handles (filtered even) sum) [1..10]
30

&gt;&gt;&gt; foldM (handlesM (filtered even) (mapM_ print)) [1..10]
2
4
6
8
10

-}</span><span>
</span><a name="line-1316"></a><span class="hs-identifier">filtered</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679056155"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679056156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056155"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056156"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679056155"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-1317"></a><a name="filtered"><a href="Control.Foldl.html#filtered"><span class="hs-identifier">filtered</span></a></a><span> </span><a name="local-6989586621679058017"><a href="#local-6989586621679058017"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679058018"><a href="#local-6989586621679058018"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679058019"><a href="#local-6989586621679058019"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-1318"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679058017"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679058019"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679058018"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679058019"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-1319"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mempty</span><span>
</span><a name="line-1320"></a><span class="hs-pragma">{-# INLINABLE filtered #-}</span><span>
</span><a name="line-1321"></a><span>
</span><a name="line-1322"></a><span class="hs-comment">{-| Perform a 'Fold' while grouping the data according to a specified group
projection function. Returns the folded result grouped as a map keyed by the
group.

-}</span><span>
</span><a name="line-1327"></a><span class="hs-identifier">groupBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679052291"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679052292"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679052291"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052292"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679052293"><span class="hs-identifier hs-type">r</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-type">Fold</span></a><span> </span><a href="#local-6989586621679052292"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679052291"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679052293"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-1328"></a><a name="groupBy"><a href="Control.Foldl.html#groupBy"><span class="hs-identifier">groupBy</span></a></a><span> </span><a name="local-6989586621679058020"><a href="#local-6989586621679058020"><span class="hs-identifier">grouper</span></a></a><span> </span><span class="hs-special">(</span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a name="local-6989586621679058021"><a href="#local-6989586621679058021"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679058022"><a href="#local-6989586621679058022"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679058023"><a href="#local-6989586621679058023"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Foldl.html#Fold"><span class="hs-identifier hs-var">Fold</span></a><span> </span><a href="#local-6989586621679058024"><span class="hs-identifier hs-var">f'</span></a><span> </span><span class="hs-identifier hs-var">mempty</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fmap</span><span> </span><a href="#local-6989586621679058023"><span class="hs-identifier hs-var">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-1329"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-1330"></a><span>    </span><a name="local-6989586621679058024"><a href="#local-6989586621679058024"><span class="hs-identifier">f'</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679058025"><a href="#local-6989586621679058025"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679058026"><a href="#local-6989586621679058026"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">alter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679058027"><a href="#local-6989586621679058027"><span class="hs-identifier">o</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058021"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromMaybe</span><span> </span><a href="#local-6989586621679058022"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679058027"><span class="hs-identifier hs-var">o</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058026"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679058020"><span class="hs-identifier hs-var">grouper</span></a><span> </span><a href="#local-6989586621679058026"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679058025"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-1331"></a><span class="hs-pragma">{-# INLINABLE groupBy #-}</span><span>
</span><a name="line-1332"></a><span>
</span><a name="line-1333"></a><span class="hs-comment">{- $reexports
    @Control.Monad.Primitive@ re-exports the 'PrimMonad' type class

    @Data.Foldable@ re-exports the 'Foldable' type class

    @Data.Vector.Generic@ re-exports the 'Vector' type class
-}</span><span>
</span><a name="line-1340"></a></pre></body></html>